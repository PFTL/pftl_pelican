<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CYPVPEJ4PK"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CYPVPEJ4PK');

  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>Deep and Shallow Copies of Objects | Python For The Lab</title>

  <meta name="tags" content="Data, Types, Mutable, Immutable, Objects, Copy, Memory, ">
  <meta name="description" content="Learn the difference between deep and shallow copies of objects in Python">
  <meta name="author" content="Aquiles Carattino">
  <link rel="canonical" href="https://pythonforthelab.com/blog/deep-and-shallow-copies-of-objects">

  <!-- Open Graph / Facebook -->
  <meta property="og:site_name" content="Python for the Lab">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://pythonforthelab.com/blog/deep-and-shallow-copies-of-objects">
  <meta property="og:title" content="Deep and Shallow Copies of Objects">
  <meta property="og:description" content="Learn the difference between deep and shallow copies of objects in Python">
  <meta property="og:image" content="/images/rebecca-georgia-269933-unsplash_linkedin.width-800.jpg">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://pythonforthelab.com/blog/deep-and-shallow-copies-of-objects">
  <meta property="twitter:title" content="Deep and Shallow Copies of Objects">
  <meta property="twitter:description" content="Learn the difference between deep and shallow copies of objects in Python">
  <meta property="twitter:image" content="/images/rebecca-georgia-269933-unsplash_linkedin.width-800.jpg">
  <meta name="twitter:creator" content="@aquicarattino">

  <link rel="apple-touch-icon" sizes="57x57"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180"
        href="https://pythonforthelab.com/theme/css/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"
        href="https://pythonforthelab.com/theme/css/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32"
        href="https://pythonforthelab.com/theme/css/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96"
        href="https://pythonforthelab.com/theme/css/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16"
        href="https://pythonforthelab.com/theme/css/favicon/favicon-16x16.png">
  <link rel="manifest" href="https://pythonforthelab.com/theme/css/favicon/manifest.json"/>
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="https://pythonforthelab.com/theme/css/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link
      href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;700&display=swap"
      rel="stylesheet">

  <link rel="stylesheet" href="https://files.stork-search.net/basic.css"/>
  <link rel="stylesheet" href="https://pythonforthelab.com/theme/css/tw_style.css">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://https://pythonforthelab.com/feed.rss">	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script type="text/javascript" src="https://pythonforthelab.com/theme/js/jquery-migrate-1.2.1.js"></script>

	<script src="https://pythonforthelab.com/theme/js/functions.js"></script>  <link rel="stylesheet" href="https://pythonforthelab.com/theme/css/prism.css"/>
</head>

<body class="text-gray-800">
  <header class="relative bg-gray-800 md:h-80 lg:flex h-64">
    <div class="lg:flex-col lg:lg:w-[880px] lg:ml-16">
      <nav class="lg:pr-8 w-full lg:pt-4">
        <div class="flex p-3 items-center justify-between">
          <a class="flex-none" href="https://pythonforthelab.com">
            <img id="site-logo" class="h-12"
                 src="https://pythonforthelab.com/theme/css/images/logo-red.svg"/>
          </a>
          <div id="menu_sm"
               class="pr-0 pl-4 grow hidden lg:block">
<ul
        class="w-full font-semibold text-3xl lg:flex lg:pl-16 lg:text-white md:text-base md:font-medium z-50">
    <li class="nav-item md:grow align-middle ">
        <a href="https://pythonforthelab.com/blog"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Blog</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://pythonforthelab.com/courses"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Courses</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://pythonforthelab.com/hire-me"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Hire Me</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://pythonforthelab.com/books"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Books</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://pythonforthelab.com/about"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">About</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://github.com/PFTL/pftl_discussions/discussions"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Forum</span>
        </a>
    </li>
    <li class="pt-4 md:hidden">
        <form action="#" class="w-full pr-8">
            <label for="search" class="relative block">
                <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                     src="https://pythonforthelab.com/theme/css/images/search.svg">
                <input id="search" data-stork="sitesearch" type="text"
                       class="text-base placeholder-gray-500 pl-10 py-4 w-full shadow-sm ring-1 ring-inset ring-gray-300 focus:border-2 focus:border-red-500 focus:ring-red-500"
                       placeholder="Type to Search">
            </label>
        </form>
        <div data-stork="sitesearch-output"></div>
    </li>
</ul>          </div>
          <div class="">
            <button id="menu-button" class="z-50 border-1 border-red-500 lg:hidden">
              <img id="hamburger" src="https://pythonforthelab.com/theme/css/images/hamburger.svg"
                   class="h-8 w-8"/>
            </button>
          </div>
        </div>
        <div id="menu"
             class="pr-0 pb-8 mx-0 pt-8 pl-12 basis-full grow bg-white z-30 min-w-full hidden drop-shadow-lg border-b-8 border-b-red-700">
<ul
        class="w-full font-semibold text-3xl md:grid md:grid-cols-6 md:px-16 md:text-base md:font-medium">
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://pythonforthelab.com/blog"
           class="before:content-blogIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Blog</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://pythonforthelab.com/courses"
           class="before:content-coursesIcon md:w-full
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Courses</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://pythonforthelab.com/hire-me"
           class="before:content-hireIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Hire Me</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://pythonforthelab.com/books"
           class="before:content-booksIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Books</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://pythonforthelab.com/about"
           class="before:content-aboutIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">About</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://github.com/PFTL/pftl_discussions/discussions"
           class="before:content-forumIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Forum</span>
        </a>
    </li>
    <li class="pt-4 md:hidden">
        <form action="#" class="w-full pr-8">
            <label for="search" class="relative block">
                <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                     src="https://pythonforthelab.com/theme/css/images/search.svg">
                <input id="search" data-stork="sitesearch" type="text"
                       class="text-base placeholder-gray-500 pl-10 py-4 w-full shadow-sm ring-1 ring-inset ring-gray-300 focus:border-2 focus:border-red-500 focus:ring-red-500"
                       placeholder="Type to Search">
            </label>
        </form>
        <div data-stork="sitesearch-output"></div>
    </li>
</ul>        </div>
      </nav>
      <div class="md:flex text-gray-200 lg:min-w-full lg:pt-4 pb-8">
      </div>
    </div>
    <div class="hidden lg:block lg:w-72 ml-1 pl-2 mr-2 pt-4 w-72">
      <div class="mb-8 shadow-2xl">
        <form action="#" class="w-full pr-8 pt-4 text-xs">
          <label for="search" class="relative block">
            <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                 src="https://pythonforthelab.com/theme/css/images/search.svg">
            <input id="search" data-stork="sitesearch" type="text"
                   class="text-gray-800 pl-10 bg-white py-2 placeholder-gray-500 w-full border border-gray-600"
                   placeholder="Type to Search">
          </label>
        </form>
        <div data-stork="sitesearch-output"></div>
      </div>
      <div class="py-2 shadow-2xl">
        <div class="text-gray-300">
          <span class="font-semibold text-sm">Get all the information directly to your inbox.</span>
        </div>
        <div id="mc_embed_signup" class="">
          <form
              action="https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&amp;id=8a0ca536e8&amp;f_id=00dfebe6f0"
              method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form"
              class="validate my-3 md:max-w-lg"
              target="_self" novalidate="">
            <div class="field-wp">
              <input type="email" name="EMAIL" placeholder="Your E-Mail" id="mce-EMAIL" required=""
                     value=""
                     class="required email bg-white ring-red-500 p-2 w-full md:max-w-2/3">
            </div>
            <div id="mce-responses" class="clear foot">
              <div class="response" id="mce-error-response" style="display: none;"></div>
              <div class="response" id="mce-success-response" style="display: none;"></div>
            </div>
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
              /* real people should not fill this in and expect good things - do not remove this or risk
              form
              bot
              signups */
              <input type="text" name="b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8" tabindex="-1" value="">
            </div>
            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
                   class="bg-emerald-500 hover:scale-105 focus:bg-emerald-300 text-white p-4 mt-2 w-full md:max-w-2/3">
          </form>
          <span class="text-gray-400 text-xs">Unsubscribe any time.</span>
        </div>
      </div>
    </div>
  </header>

  <div class="lg:mx-auto lg:flex lg:ml-16">

    <div id="col-left" class="md:content-stretch lg:w-[880px]">
      <div class="relative text-gray-800 mx-2 z-40">
        <div class="md:-mt-32 lg:-mt-56 -mt-36 lg:mb-8">
          <img src="/images/rebecca-georgia-269933-unsplash_linkedin.width-800.jpg" alt="Deep and Shallow Copies of Objects" class="shadow-md lg:shadow-lg"/>
        </div>
        <h1 class="font-serif font-extrabold text-4xl leading-tight pb-2">Deep and Shallow Copies of Objects</h1>
        <div class="font-sans font-bold text-xl">Learn the difference between deep and shallow copies of objects in Python</div>
        <div class="text-sm text-gray-400">
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-profile mr-1 pr-1 py-1">Aquiles Carattino</span>
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-calendar mr-1 pr-1 py-1">2019-02-04</span>
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-tag mr-1 pr-1 py-1">
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Data</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Types</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Mutable</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Immutable</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Objects</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Copy</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">Memory</span>
        </span>
        </div>
      </div>

      <div class="article-content mt-4 mx-2">
        <main>
          <p>Copying objects in Python seems like a trivial task, but it can have
unexpected implications in your programs. Copying data may be achieved
by either duplicating the data or by storing references to the objects,
having a much lower impact on the memory. In this article, we are going
to review the differences between deep and shallow copies of objects in
Python, including custom classes.</p>
<p>The discussion of deep and shallow copies is only worth having in the
context of <a href="https://pythonforthelab.com/blog/mutable-and-immutable-objects">mutable data
types</a>, so if you are not
sure of what that means, you can check the linked article. To refresh
your memory, let's see quickly what happens when you copy a list, for
example:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; a = [1, 2, 3]
&gt;&gt;&gt; b = a
&gt;&gt;&gt; print(b)
[1, 2, 3]
&gt;&gt;&gt; a[0] = 0
&gt;&gt;&gt; print(b)
[0, 2, 3]
</code></pre>
<p>You see that if you change one element <code>a</code>, it will be reflected also in
<code>b</code>. If you want to prevent this behavior, you can do the following:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; a = [1, 2, 3]
&gt;&gt;&gt; b = list(a)
&gt;&gt;&gt; a[0] = 0
&gt;&gt;&gt; print(b)
[1, 2, 3]
</code></pre>
<p>Now you see that you have two independent objects. You can also verify
it by running <code>id(a)</code> and <code>id(b)</code> and checking that they are effectively
different. However, this is not the end of the discussion. Let's see
what happens if you have a list of lists:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; a = [[1, 2, 3], [4, 5, 6]]
&gt;&gt;&gt; b = list(a)
</code></pre>
<p>If you check <code>id(a)</code> and <code>id(b)</code> you will see that they are different.
You can go one step further and change a:</p>
<blockquote>
<p>&gt;&gt;&gt; a.append([7, 8, 9]) &gt;&gt;&gt; print(b) [[1, 2,
3], [4, 5, 6]]</p>
</blockquote>
<p>This looks like great news until you do the following:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; a[0][0] = 0
&gt;&gt;&gt; print(b)
[[0, 2, 3], [4, 5, 6]]
</code></pre>
<p>We changed <code>a</code> and <code>b</code> also changed! I bet you didn't see that coming.
What does this mean? Here is where deep and shallow copies enter into
play. When we copied <code>a</code> into <code>b</code> by doing <code>list(a)</code>, we performed a
shallow copy. This means that we created a new element (that is why the
id is different), but the references to other elements are still the
same. We can see that by checking the id of the first element of both
<code>a</code> and <code>b</code>:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; id(a[0])
140381216067976
&gt;&gt;&gt; id(b[0])
140381216067976
</code></pre>
<p>A shallow copy is, as the name suggests, a superficial copy. Only the
first layer is created new, but not the underlying ones. The same is
true for dictionaries, for example. Regarding lists, there is another
way of making a shallow copy:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; b = a[:]
</code></pre>
<p>While for dictionaries you can use:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; my_dict = {'a': [1, 2, 3], 'b': [4, 5, 6]}
&gt;&gt;&gt; new_dict = my_dict.copy()
&gt;&gt;&gt; other_option = dict(my_dict)
</code></pre>
<p>If you want to create a deep copy, which as the name suggests creates
completely new objects, including referred ones, you need to use the
<code>copy</code> module. Let's start by checking how to perform a shallow copy:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; import copy
&gt;&gt;&gt; b = copy.copy(a)
&gt;&gt;&gt; id(a[0])
140381216067976
&gt;&gt;&gt; id(b[0])
140381216067976
</code></pre>
<p>I hope the example above is enough for you to understand what it means.
If you want to make a deep copy, the command is, as expected,
<code>deepcopy</code>:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; c = copy.deepcopy(a)
&gt;&gt;&gt; id(c[0])
140381217929672
</code></pre>
<h2>Copies of Custom Classes</h2>
<p>We have seen the differences between deep and shallow copies of standard
python data types such as lists and dictionaries. Now it is important to
see what happens when you define your own classes that also reference
other mutable objects. Let's quickly see what happens if you copy your
custom class:</p>
<pre><code class="language-python">class MyClass:
    def __init__(self, x, y):
        self.x = x
        self.y = y

my_class = MyClass([1, 2], [3, 4])
my_new_class = my_class

print(id(my_class))
print(id(my_new_class))

my_class.x[0] = 0
print(my_new_class.x)
</code></pre>
<p>Which will generate the following output:</p>
<pre><code class="language-python">140397059541368
140397059541368
[0, 2]
</code></pre>
<p>You see that by simply copying the class with the <code>=</code> , we get two
references to the same object, and therefore the id is the same.
Moreover, if one of the mutable attributes of the class changes, it will
also change in all the other objects. An easy solution would be to use
the <code>copy</code> module:</p>
<pre><code class="language-python">import copy
my_class = MyClass([1, 2], [3, 4])
my_new_class = copy.copy(my_class)

print(id(my_class))
print(id(my_new_class))

my_class.x[0] = 0
print(my_new_class.x)
</code></pre>
<p>I've suppressed the definition of the class for brevity. The output of
the above code would be:</p>
<pre><code class="language-python">140129009113464
140129008512416
[0, 2]
</code></pre>
<p>You can see that now they got different <code>id</code> values, but the objects
they reference are still the same. If you change <code>copy</code> by <code>deepcopy</code>,
the behavior would change, exactly in the same way than with lists or
dictionaries. But we can go one step further, and customize the behavior
of the shallow or deep copies of objects.</p>
<h2>Custom shallow and deep copies of objects</h2>
<p>With Python, you have a very high level of granularity regarding how
much control you have on every step, including deep and shallow copies.
In order to have control, you need to override the methods <code>__copy__</code>
and <code>__deepcopy__</code>, let's see how and then we see why. First, imagine
that you want to be able to copy a class with all its references but
one, which you need to be independent of one instance of your class to
another. You can do:</p>
<pre><code class="language-python">class MyClass:
    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.other = [1, 2, 3]

    def __copy__(self):
        new_instance = MyClass(self.x, self.y)
        new_instance.__dict__.update(self.__dict__)
        new_instance.other = copy.deepcopy(self.other)
        return new_instance
</code></pre>
<p>Let's go step by step. When you use <code>copy.copy</code>, the method that will be
executed is <code>__copy__</code> and the argument is the object itself. The return
is going to be the copied object. To make a copy, the first thing is to
instantiate the new class, which we do by calling <code>MyClass</code> again. You
can make more general by replacing <code>MyClass</code> with <code>type(self)</code>.</p>
<p>Anyhow, the next step is to copy all the attributes of the base instance
into the new one. This can be quickly done by updating the <code>__dict__</code>
attribute. If you are not familiar with it, we are going to quickly
explore it later. These two steps alone define the standard behavior for
a shallow copy of an object. In order to achieve a special
functionality, we add one more line, in which the <code>other</code> attribute is
copied with a deep copy. <code>other</code> was not part of the <code>__init__</code> just to
show you that we can add on any attribute of the class.</p>
<p>Finally, if we repeat the simple tests of before, we would get:</p>
<pre><code class="language-python">my_class = MyClass([1, 2], [3, 4])
my_new_class = copy.copy(my_class)

print(id(my_class))
print(id(my_new_class))

my_class.x[0] = 0
my_class.y[0] = 0
my_class.other[0] = 0
print(my_new_class.x)
print(my_new_class.y)
print(my_new_class.other)
</code></pre>
<p>And the output would be:</p>
<pre><code class="language-python">139816535263552
139816535263720
[0, 2]
[0, 4]
[1, 2, 3]
</code></pre>
<p>As you can see, the attribute <code>other</code> was deep copied and therefore if
you change it in one class, it won't change in the other.</p>
<h2>About the dict attribute</h2>
<p>In the previous section, we used the <code>__dict__</code> attribute of a class,
and that may not be something standard for you. Allow me this short
digression before going back to the main subject of the article. As you
know, objects contain attributes, and these attributes are always
defined as variables which in the end look like strings (i.e., you can
read them, type them with your keyboard, etc.)</p>
<p>This makes it possible to think the collection of attributes as a
dictionary. In the class from the previous section, you can explore this
idea by doing to following:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; print(my_class.__dict__)
{'x': [0, 2], 'y': [0, 4], 'other': [1, 2, 3]}
</code></pre>
<p>I hope you are seeing the gist of this. You can also alter the
<code>__dict__</code> directly:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; my_class.__dict__['x'] = [1, 1]
&gt;&gt;&gt; my_class.x
[1, 1]
</code></pre>
<p>It means that you can either use the <code>.x</code> or the <code>__dict__['x']</code> to work
with the same element in your object. This is also a quick way of
knowing all the attributes that are defined in your object, etc. Hope
this short story can help clarify a topic that is not that trivial for
newcomers to the deeps of object-oriented python programming.</p>
<h2>Custom deep copy</h2>
<p>Back in the track to the main topic of the article, we need to customize
the deep copy of the class. It is very similar to the <code>__copy__</code> method,
but it takes one more argument:</p>
<pre><code class="language-python">class MyClass:
    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.other = [1, 2, 3]

    def __deepcopy__(self, memodict={}):
        new_instance = MyClass(self.x, self.y)
        new_instance.__dict__.update(self.__dict__)
        new_instance.x = copy.deepcopy(self.x, memodict)
        new_instance.y = copy.deepcopy(self.y, memodict)
        return new_instance
</code></pre>
<p>It looks very similar to the <code>copy</code>, but the requirement of the extra
argument <code>memodict</code> is rooted at what deep copying means. Since every
object referenced from the initial class has to be recreated, there is a
risk of an infinite recursion. This can happen if one object somehow
references itself. Even if not an infinite recursion loop, you may end
up copying several times the same data. The <code>memodict</code> is keeping track
of the objects already copied. The infinite recursion is what we can
prevent overwriting the <code>__deepcopy__</code> method.</p>
<p>In the example above, what we do is we prevent the deep copy process
from generating a new <code>other</code> list. Therefore, we end up with a mixed
deep copy, in which <code>x</code> and <code>y</code> are really new, while <code>other</code> is the
same. If we run the example code,</p>
<pre><code class="language-python">my_class = MyClass([1, 2], [3, 4])
my_new_class = copy.deepcopy(my_class)

print(id(my_class))
print(id(my_new_class))

my_class.x[0] = 0
my_class.y[0] = 0
my_class.other[0] = 0
print(my_new_class.x)
print(my_new_class.y)
print(my_new_class.other)
</code></pre>
<p>We will get the following output:</p>
<pre><code class="language-python">139952436046312
139952436046200
[1, 2]
[3, 4]
[0, 2, 3]
</code></pre>
<p>So, you see now, that <code>.x</code> and <code>.y</code> are unchanged, while <code>.other</code>
reflects the changes done on the other class.</p>
<h2>Why defining how to copy</h2>
<p>The simple examples above only show how to achieve different behavior
with deep and shallow copies, but they don't explain why you would do
it. The cases in which you will need to define this custom behavior are
not trivial at all. Customizing the deep copy would happen if, for
instance, the class is holding any kind of cache, and you need to
preserve it between different objects. Preserving the cache can be
useful because you can speed up the code, or because it is very large
and you don't want to duplicate the memory usage.</p>
<p>For shallow copies, the use cases are varied. It normally implies that
there is at least one attribute that you don't want to share between
objects. That attribute could be, for instance, the object responsible
for communicating with a device. You would like to prevent talking at
exactly the same time to the same device through the same interface. You
may also like to protect private attributes, etc.</p>
<h2>Last Warning</h2>
<p>It is very important to point out that, if are worried about copying and
deep copying of custom objects, you should understand what are <a href="https://pythonforthelab.com/blog/mutable-and-immutable-objects">mutable
and immutable</a> objects in
Python, and what are <a href="https://pythonforthelab.com/blog/what-are-hashable-objects">hashable
objects</a>. When you have immutable
data types, such as an integer or a string, all the discussion above
doesn't work. If you change an immutable attribute in a class, that
attribute in deep-copied objects will not change.</p>
<p>Therefore, the idea of preserving attributes between objects, etc. only
works with mutable objects. If you want to achieve the behavior of
sharing data between objects as a feature, you will need to think how to
transform it to mutable types or find ways around it.</p>
<p>Another word of caution goes for people working with <code>multiprocessing</code>.
It may be obvious but is never bad to repeat it, that sharing data
between different processes is not a trivial task and therefore you
can't rely on mutable objects to share information.</p>
<p>Header photo by <a href="https://unsplash.com/photos/Dff-4JbYq0Y?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Rebecca
Georgia</a>
on Unsplash</p>
        </main>
      </div>
      <div class="flex border-t text-lg px-4 pt-6 lg:pt-12 lg:mb-12">
        <div
            class="before:inset-y-1/2 before:inset-x-1 before:content-article before:h-6 before:w-6 before:inline-block before:align-middle"></div>
        <div class="pl-8 text-gray-600 font-light">Article written by Aquiles Carattino</div>
      </div>

      <div class="pt-4 pb-6 md:px-4 border-t border-gray-200 justify-center">
        <div class="bg-gray-300 font-serif text-2xl md:text-4xl text-center md:p-6 p-2">Join our newsletter!</div>
        <div class="py-4">If you liked the content, sign up to never miss an update.
        </div>
        <div id="mc_embed_signup" class="">
          <form
              action="https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&amp;id=8a0ca536e8&amp;f_id=00dfebe6f0"
              method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form"
              class="validate my-3 md:flex md:max-w-lg"
              target="_self" novalidate="">
            <div class="field-wp">
              <input type="email" name="EMAIL" placeholder="Your E-Mail" id="mce-EMAIL" required=""
                     value=""
                     class="required email bg-gray-100 ring-red-500 p-4 w-full md:max-w-2/3">
            </div>
            <div id="mce-responses" class="clear foot">
              <div class="response" id="mce-error-response" style="display: none;"></div>
              <div class="response" id="mce-success-response" style="display: none;"></div>
            </div>
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
              /* real people should not fill this in and expect good things - do not remove this or risk
              form
              bot
              signups */
              <input type="text" name="b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8" tabindex="-1" value="">
            </div>
            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
                   class="bg-emerald-500 hover:scale-105 w-full focus:bg-emerald-300 text-white p-4 mt-2 md:ml-4 md:mt-0 md:w-40">
          </form>
        </div>
      </div>

        <div class="lg:mt-6">
          <h2 class="font-serif font-semibold text-2xl leading-tight">Related Articles</h2>
          <div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="blog/mutable-and-immutable-objects" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/rawpixel-274862-unsplash_linkedin.width-800.jpg"
                           alt="Illustration of Mutable and Immutable Objects">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2018-08-23</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">Mutable and Immutable Objects</h3>
                      <div class="font-sans ">People who start programming in Python quickly stumble upon the existence of lists and tuples. They are defined in a similar way, they look the same. Sometimes they are even used interchangeably. The obvious question is, therefore, why do you have two different types of elements for the same goal …</div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="blog/mutable-and-immutable-attributes-of-classes" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/dan-gold-382057-unsplash_linkedin.width-800.jpg"
                           alt="Illustration of Mutable and Immutable Attributes of Classes">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2018-08-24</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">Mutable and Immutable Attributes of Classes</h3>
                      <div class="font-sans ">We have seen how to leverage the differences between mutable and immutable objects and what happens when you use mutable types as default function arguments. However, we haven't discussed what happens when you use mutable types as default attributes of classes. Default values for attributes can be defined in different …</div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="blog/mutable-or-immutable-tuples" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/michal-pechardo-502908-unsplash_linkedin.width-800.jpg"
                           alt="Illustration of Mutable or Immutable Tuples">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2018-08-24</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">Mutable or Immutable Tuples</h3>
                      <div class="font-sans ">Broadly speaking, Python variables belong to one of two types: mutable and immutable. We have discussed this yesterday, in the Introduction To Mutable and Immutable Data Types. The first one refers to those elements that can be changed without the need of creating a new one, while the latter refers …</div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
          </div>
        </div>
      <div class="px-2 lg:text-center lg:mt-8">
        <h4 class="text-2xl leading-tight lg:mx-auto lg:text-4xl">Share your thoughts with us!</h4>
        <div class="comments">
          <!-- Comment -->
          <script src="https://utteranc.es/client.js"
                  repo="PFTL/pftl_discussions"
                  issue-term="pathname"
                  label="Comment"
                  theme="github-light"
                  crossorigin="anonymous"
                  async>
          </script>
        </div>
      </div>
    </div>
    <div id="col-right" class="lg:w-72">
      <div class="bg-gray-300 place-items-center mt-3 p-6">
        <h3 class="font-serif text-2xl text-center mb-2 font-semibold mx-auto lg:text-xl">Support Us</h3>
        <p class="font-serif lg:text-sm leading-tight mb-2">If you like the content of this website, consider buying a
          copy of
          the book
          <strong>Python For The
            Lab</strong></p>
        <a href="https://pythonforthelab.com/books">
          <button class="bg-emerald-500 hover:scale-105 focus:bg-emerald-300 text-white p-4 mt-2 w-full md:max-w-2/3">
            Check out the books
          </button>
        </a>
      </div>

      <div class="mt-3 border border-gray-400  place-items-center">
          <h3 class="bg-gray-300 font-serif text-2xl lg:text-xl lg:font-bold text-center py-4">Latest Articles</h3>
          <ul class="mt-4">
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/instructions-to-build-the-python-for-the-lab-daq/" class="font-lg leading-tight hover:font-bold">
                  <div>Instructions to build the Python for the Lab DAQ.</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2021-03-27</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/using-slots-in-python-limit-dynamic-attribute-creation-and-improve-speed" class="font-lg leading-tight hover:font-bold">
                  <div>Using slots in Python: limit dynamic attribute creation and improve speed</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2021-03-21</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/getting-started-with-basler-cameras" class="font-lg leading-tight hover:font-bold">
                  <div>Acquiring images from Basler Cameras</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2021-02-27</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/singletons-instantiate-objects-only-once" class="font-lg leading-tight hover:font-bold">
                  <div>Singletons: Instantiate objects only once</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2021-01-16</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/differences-between-multiprocessing-windows-and-linux" class="font-lg leading-tight hover:font-bold">
                  <div>Differences of Multiprocessing on Windows and Linux</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-06-13</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/python-tip-using-else-loops" class="font-lg leading-tight hover:font-bold">
                  <div>Python Tip: Using Else with Loops</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-05-25</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/python-tip-ready-publish-matplotlib-figures" class="font-lg leading-tight hover:font-bold">
                  <div>Python Tip: Ready to Publish Matplotlib Figures</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-05-18</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/data-descriptors-bringing-attributes-next-level" class="font-lg leading-tight hover:font-bold">
                  <div>Data Descriptors: Bringing Attributes to the Next level</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-05-16</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/python-tips-using-sets" class="font-lg leading-tight hover:font-bold">
                  <div>Python Tips: Using Sets</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-05-11</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400">
                <a href="https://pythonforthelab.com/blog/generators-iterables-iterators-python-when-and-where" class="font-lg leading-tight hover:font-bold">
                  <div>Generators, Iterables, Iterators in Python: When and Where</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2020-04-10</div>
                </a>
              </li>
          </ul>
      </div>
    </div>
  </div>


<!-- Footer -->
<footer class="w-full bg-black text-white p-8">
  <div class="flex flex-row flex-wrap items-center justify-center gap-y-6 gap-x-12 text-center md:justify-between">
    <img src="https://pythonforthelab.com/theme/css/images/logo-red.svg" alt="logo-ct" class="w-20" />
    <ul class="flex flex-wrap items-center gap-y-2 gap-x-8">
      <li>
        <a
          href="https://pythonforthelab.com/about"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          About Us
        </a>
      </li>
      <li>
        <a
          href="https://pythonforthelab.com/cookie-policy"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Cookie Policy
        </a>
      </li>
      <li>
        <a
          href="https://pythonforthelab.com/privacy-policy"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Privacy Policy
        </a>
      </li>
      <li>
        <a
          href="https://pythonforthelab.com/contact-us"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Contact Us
        </a>
      </li>
    </ul>
  </div>
  <hr class="my-8 border-blue-gray-50" />
  <p class="block text-center font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased">
    © 2023 Python for the Lab
  </p>
</footer><script src="https://pythonforthelab.com/theme/js/prism.js"></script>
<script src="https://files.stork-search.net/releases/v1.5.0/stork.js"></script>
<script>
    stork.register("sitesearch", "https://pythonforthelab.com/search-index.st");
</script>

<script>
    $(document).ready(function () {
        responsive_menu = $('#menu');
        nav = $('nav');
        $('#menu-button').on('click', function (e) {
            e.preventDefault();
            if (responsive_menu.is(':hidden')) {
                responsive_menu.slideToggle();
                nav.addClass('bg-white');
                $("#site-logo").attr("src", "https://pythonforthelab.com/theme/css/images/logo-classic.svg");
                $('hamburger').slideToggle();
                $('#hamburger').attr('src', 'https://pythonforthelab.com/theme/css/images/cross.svg');
            } else {
                responsive_menu.slideToggle();
                nav.removeClass('bg-white');
                $("#site-logo").attr("src", "https://pythonforthelab.com/theme/css/images/logo-red.svg");
                $('#hamburger').attr('src', 'https://pythonforthelab.com/theme/css/images/hamburger.svg');
            }
        });
        position = $(window).height();
        $(window).scroll(function () {
            var currentScroll = $(window).scrollTop();
            if (currentScroll >= position) {
                $('#sticky_menu').addClass('lg:block');
            } else {
                $('#sticky_menu').removeClass('lg:block');
            }
        });
    });
</script></body>
</html>