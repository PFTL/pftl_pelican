<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CYPVPEJ4PK"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CYPVPEJ4PK');

  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>Handling and Sharing Data Between Threads | Python For The Lab</title>

  <meta name="tags" content="threading, data, queue, sharing, threads, async, multithreading, ">
  <meta name="description" content="Sharing data between threads in Python, race conditions, and the limits of the global interpreter lock">
  <meta name="author" content="Aquiles Carattino">
  <link rel="canonical" href="http://localhost:8000/blog/handling-and-sharing-data-between-threads">

  <!-- Open Graph / Facebook -->
  <meta property="og:site_name" content="Python for the Lab">
  <meta property="og:type" content="article">
  <meta property="og:url" content="http://localhost:8000/blog/handling-and-sharing-data-between-threads">
  <meta property="og:title" content="Handling and Sharing Data Between Threads">
  <meta property="og:description" content="Sharing data between threads in Python, race conditions, and the limits of the global interpreter lock">
  <meta property="og:image" content="/images/python1-01.width-800.png">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="http://localhost:8000/blog/handling-and-sharing-data-between-threads">
  <meta property="twitter:title" content="Handling and Sharing Data Between Threads">
  <meta property="twitter:description" content="Sharing data between threads in Python, race conditions, and the limits of the global interpreter lock">
  <meta property="twitter:image" content="/images/python1-01.width-800.png">
  <meta name="twitter:creator" content="@aquicarattino">

  <link rel="apple-touch-icon" sizes="57x57"
        href="http://localhost:8000/theme/css/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60"
        href="http://localhost:8000/theme/css/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72"
        href="http://localhost:8000/theme/css/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76"
        href="http://localhost:8000/theme/css/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114"
        href="http://localhost:8000/theme/css/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120"
        href="http://localhost:8000/theme/css/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144"
        href="http://localhost:8000/theme/css/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152"
        href="http://localhost:8000/theme/css/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180"
        href="http://localhost:8000/theme/css/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"
        href="http://localhost:8000/theme/css/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32"
        href="http://localhost:8000/theme/css/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96"
        href="http://localhost:8000/theme/css/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16"
        href="http://localhost:8000/theme/css/favicon/favicon-16x16.png">
  <link rel="manifest" href="http://localhost:8000/theme/css/favicon/manifest.json"/>
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="http://localhost:8000/theme/css/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link
      href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;700&display=swap"
      rel="stylesheet">

  <link rel="stylesheet" href="https://files.stork-search.net/basic.css"/>
  <link rel="stylesheet" href="http://localhost:8000/theme/css/tw_style.css">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://http://localhost:8000/feed.rss">	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script type="text/javascript" src="http://localhost:8000/theme/js/jquery-migrate-1.2.1.js"></script>

	<script src="http://localhost:8000/theme/js/functions.js"></script>  <link rel="stylesheet" href="http://localhost:8000/theme/css/prism.css"/>
</head>

<body class="text-gray-800">
  <header class="relative bg-gray-800 md:h-80 lg:flex h-64">
    <div class="lg:flex-col lg:lg:w-[880px] lg:ml-16">
      <nav class="lg:pr-8 w-full lg:pt-4">
        <div class="flex p-3 items-center justify-between">
          <a class="flex-none" href="http://localhost:8000">
            <img id="site-logo" class="h-12"
                 src="http://localhost:8000/theme/css/images/logo-red.svg"/>
          </a>
          <div id="menu_sm"
               class="pr-0 pl-4 grow hidden lg:block">
<ul
        class="w-full font-semibold text-3xl lg:flex lg:pl-16 lg:text-white md:text-base md:font-medium z-50">
    <li class="nav-item md:grow align-middle ">
        <a href="http://localhost:8000/blog"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Blog</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="http://localhost:8000/courses"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Courses</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="http://localhost:8000/hire-me"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Hire Me</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="http://localhost:8000/books"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Books</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="http://localhost:8000/about"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">About</span>
        </a>
    </li>
    <li class="nav-item md:grow align-middle ">
        <a href="https://github.com/PFTL/pftl_discussions/discussions"
           class="md:pt-6 md:pb-2 hover:border-b-2 hover:border-red-400">
            <span class="">Forum</span>
        </a>
    </li>
    <li class="pt-4 md:hidden">
        <form action="#" class="w-full pr-8">
            <label for="search" class="relative block">
                <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                     src="http://localhost:8000/theme/css/images/search.svg">
                <input id="search" data-stork="sitesearch" type="text"
                       class="text-base placeholder-gray-500 pl-10 py-4 w-full shadow-sm ring-1 ring-inset ring-gray-300 focus:border-2 focus:border-red-500 focus:ring-red-500"
                       placeholder="Type to Search">
            </label>
        </form>
        <div data-stork="sitesearch-output"></div>
    </li>
</ul>          </div>
          <div class="">
            <button id="menu-button" class="z-50 border-1 border-red-500 lg:hidden">
              <img id="hamburger" src="http://localhost:8000/theme/css/images/hamburger.svg"
                   class="h-8 w-8"/>
            </button>
          </div>
        </div>
        <div id="menu"
             class="pr-0 pb-8 mx-0 pt-8 pl-12 basis-full grow bg-white z-30 min-w-full hidden drop-shadow-lg border-b-8 border-b-red-700">
<ul
        class="w-full font-semibold text-3xl md:grid md:grid-cols-6 md:px-16 md:text-base md:font-medium">
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="http://localhost:8000/blog"
           class="before:content-blogIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Blog</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="http://localhost:8000/courses"
           class="before:content-coursesIcon md:w-full
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Courses</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="http://localhost:8000/hire-me"
           class="before:content-hireIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Hire Me</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="http://localhost:8000/books"
           class="before:content-booksIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Books</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="http://localhost:8000/about"
           class="before:content-aboutIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">About</span>
        </a>
    </li>
    <li class="nav-item align-middle md:h-16 md:pl-8  md:shadow-xl md:hover:shadow-2xl md:active:shadow-none">
        <a href="https://github.com/PFTL/pftl_discussions/discussions"
           class="before:content-forumIcon
            before:inline-block before:align-middle before:h-6 before:w-6 md:py-6 md:pr-12
            before:md:h-8 before:md:w-8">
            <span class="">Forum</span>
        </a>
    </li>
    <li class="pt-4 md:hidden">
        <form action="#" class="w-full pr-8">
            <label for="search" class="relative block">
                <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                     src="http://localhost:8000/theme/css/images/search.svg">
                <input id="search" data-stork="sitesearch" type="text"
                       class="text-base placeholder-gray-500 pl-10 py-4 w-full shadow-sm ring-1 ring-inset ring-gray-300 focus:border-2 focus:border-red-500 focus:ring-red-500"
                       placeholder="Type to Search">
            </label>
        </form>
        <div data-stork="sitesearch-output"></div>
    </li>
</ul>        </div>
      </nav>
      <div class="md:flex text-gray-200 lg:min-w-full lg:pt-4 pb-8">
      </div>
    </div>
    <div class="hidden lg:block lg:w-72 ml-1 pl-2 mr-2 pt-4 w-72">
      <div class="mb-8 shadow-2xl">
        <form action="#" class="w-full pr-8 pt-4 text-xs">
          <label for="search" class="relative block">
            <img class="absolute w-4 h-4 top-1/2 -translate-y-1/2 left-3"
                 src="http://localhost:8000/theme/css/images/search.svg">
            <input id="search" data-stork="sitesearch" type="text"
                   class="text-gray-800 pl-10 bg-white py-2 placeholder-gray-500 w-full border border-gray-600"
                   placeholder="Type to Search">
          </label>
        </form>
        <div data-stork="sitesearch-output"></div>
      </div>
      <div class="py-2 shadow-2xl">
        <div class="text-gray-300">
          <span class="font-semibold text-sm">Get all the information directly to your inbox.</span>
        </div>
        <div id="mc_embed_signup" class="">
          <form
              action="https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&amp;id=8a0ca536e8&amp;f_id=00dfebe6f0"
              method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form"
              class="validate my-3 md:max-w-lg"
              target="_self" novalidate="">
            <div class="field-wp">
              <input type="email" name="EMAIL" placeholder="Your E-Mail" id="mce-EMAIL" required=""
                     value=""
                     class="required email bg-white ring-red-500 p-2 w-full md:max-w-2/3">
            </div>
            <div id="mce-responses" class="clear foot">
              <div class="response" id="mce-error-response" style="display: none;"></div>
              <div class="response" id="mce-success-response" style="display: none;"></div>
            </div>
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
              /* real people should not fill this in and expect good things - do not remove this or risk
              form
              bot
              signups */
              <input type="text" name="b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8" tabindex="-1" value="">
            </div>
            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
                   class="bg-emerald-500 hover:scale-105 focus:bg-emerald-300 text-white p-4 mt-2 w-full md:max-w-2/3">
          </form>
          <span class="text-gray-400 text-xs">Unsubscribe any time.</span>
        </div>
      </div>
    </div>
  </header>

  <div class="lg:mx-auto lg:flex lg:ml-16">

    <div id="col-left" class="md:content-stretch lg:w-[880px]">
      <div class="relative text-gray-800 mx-2 z-40">
        <div class="md:-mt-32 lg:-mt-56 -mt-36 lg:mb-8">
          <img src="/images/python1-01.width-800.png" alt="Handling and Sharing Data Between Threads" class="shadow-md lg:shadow-lg"/>
        </div>
        <h1 class="font-serif font-extrabold text-4xl leading-tight pb-2">Handling and Sharing Data Between Threads</h1>
        <div class="font-sans font-bold text-xl">Sharing data between threads in Python, race conditions, and the limits of the global interpreter lock</div>
        <div class="text-sm text-gray-400">
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-profile mr-1 pr-1 py-1">Aquiles Carattino</span>
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-calendar mr-1 pr-1 py-1">2019-08-06</span>
          <span
              class="inline-block before:inline-block before:mx-1 before:align-middle before:h-4 before:w-4 before:content-tag mr-1 pr-1 py-1">
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">threading</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">data</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">queue</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">sharing</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">threads</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">async</span>
              <span class="bg-gray-300 rounded text-white px-0.5 mr-0.5 ">multithreading</span>
        </span>
        </div>
      </div>

      <div class="article-content mt-4 mx-2">
        <main>
          <p>When working with threads in Python, you will find very useful to be
able to share data between different tasks. One of the advantages of
threads in Python is that they share the same memory space, and thus
exchanging information is relatively easy. However, some structures can
help you achieve more specific goals.</p>
<p>In the previous article, we have covered <a href="http://localhost:8000/blog/starting-and-synchronizing-threads">how to start and synchronize
threads</a> and now it is time to
expand the toolbox to handle the exchange of information between them.</p>
<h2>Shared Memory</h2>
<p>The first and most naive approach is to use the same variables in
different threads. We have already used this feature in the <a href="http://localhost:8000/blog/starting-and-synchronizing-threads">previous
tutorial</a>, but without discussing
it explicitly. Let's see how we can use shared memory through a very
simple example:</p>
<pre><code class="language-python">from threading import Thread, Event
from time import sleep

event = Event()

def modify_variable(var):
    while True:
        for i in range(len(var)):
            var[i] += 1
        if event.is_set():
            break
        sleep(.5)
    print('Stop printing')


my_var = [1, 2, 3]
t = Thread(target=modify_variable, args=(my_var, ))
t.start()
while True:
    try:
        print(my_var)
        sleep(1)
    except KeyboardInterrupt:
        event.set()
        break
t.join()
print(my_var)
</code></pre>
<p>The example above is almost trivial, but it has a very important
feature. We start a new thread by passing an argument, <code>my_var</code>, which
is a list of numbers. The thread will increase the values of the numbers
by one, with a certain delay. In this example we use events to
graciously finish the thread, if you are not familiar with them, check
the <a href="http://localhost:8000/blog/starting-and-synchronizing-threads">previous tutorial</a>.</p>
<p>The important piece of code in this example is the <code>print(my_var)</code> line.
That print statement lives in the main thread, however, it has access to
the information being generated within a child thread. This behavior is
possible thanks to memory sharing between different threads. Being able
to access the same memory space is useful, but it can also pose some
risks. In the example above, we have started only one thread, but we are
not limited to that. We could, for example, start several threads:</p>
<pre><code class="language-python">t = Thread(target=modify_variable, args=(my_var, ))
t2 = Thread(target=modify_variable, args=(my_var, ))
t.start()
t2.start()
</code></pre>
<p>And you would see that <code>my_var</code> and its information is shared across all
threads. This is good for applications like the one above, in which it
doesn't matter which thread adds one to the variable. Or does it? Let's
slightly modify the code that runs in the thread. Let's remove the
<code>sleep</code>:</p>
<pre><code class="language-python">def modify_variable(var):
    while True:
        for i in range(len(var)):
            var[i] += 1
        if event.is_set():
            break
        # sleep(.5)
    print('Stop printing')
</code></pre>
<p>Now, when we run the code, there will be no sleep in between one
iteration and the next. Let's run it for a short time, let's say 5
seconds, we can do the following:</p>
<pre><code class="language-python">from time import time
[...]

my_var = [1, 2, 3]
t = Thread(target=modify_variable, args=(my_var, ))
t.start()
t0 = time()
while time()-t0 &lt; 5:
    print(my_var)
    sleep(1)
event.set()
t.join()
print(my_var)
</code></pre>
<p>I've suppressed the parts of the code which repeat. If you run this
code, you will get as outputs very large numbers. In my case, I got:</p>
<pre><code class="language-python">[6563461, 6563462, 6563463]
</code></pre>
<p>There is, however, a very important feature to notice. The three numbers
are consecutive. This is expected because the starting variable was
<code>[1, 2, 3]</code> and we are adding one to each variable. Let's start a second
thread this time and see what the output is:</p>
<pre><code class="language-python">my_var = [1, 2, 3]
t = Thread(target=modify_variable, args=(my_var, ))
t2 = Thread(target=modify_variable, args=(my_var, ))
t.start()
t2.start()
t0 = time()
while time()-t0 &lt; 5:
    try:
        print(my_var)
        sleep(1)
    except KeyboardInterrupt:
        event.set()
        break
event.set()
t.join()
t2.join()
print(my_var)
</code></pre>
<p>I've got as an output the following values:</p>
<pre><code class="language-python">[5738447, 5686971, 5684220]
</code></pre>
<p>You can first note that they are not larger than before, meaning that
running two threads instead of one could actually be slower for this
operation. The other thing to note is that the values are no consecutive
to each other! And this is a very important behavior that can appear
when working with multiple threads in Python. If you think really hard,
can you explain where this issue is coming from?</p>
<p>In the <a href="http://localhost:8000/blog/starting-and-synchronizing-threads">previous tutorial</a>, we
discussed that threads are handled by the operating system, which
decides when to spin one on or off. We have no control over what the
operating system decides to do. In the example above, since there is no
<code>sleep</code> in the loop, the operating system will have to decide when to
stop one and start another thread. However, that does not explain
completely the output we are getting. It doesn't matter if one thread
runs first and stops, etc. we are always adding <code>+1</code> to each element.</p>
<p>The problem with the code above is in the line <code>var[i] += 1</code>, which is
actually two operations. First, it copies the value from <code>var[i]</code> and
ads <code>1</code>. Then it stores the value back to <code>var[i]</code>. In between these two
operations, the operating system may decide to switch from one task to
another. In such case, the value both tasks see in the list is the same,
and therefore instead of adding <code>+1</code> twice, we do it only once. If you
want to do it even more noticeable, you can start two threads, one that
adds and one that subtracts from a list, and that would give you a quick
hint of which thread runs faster. In my case, I got the following
output:</p>
<pre><code class="language-python">[-8832, -168606, 2567]
</code></pre>
<p>But if I run it another time, I get:</p>
<pre><code class="language-python">[97998, 133432, 186591]
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may notice that there is a delay between the <code>start</code> of both
threads, which may give a certain advantage to the first thread started.
However, that alone cannot explain the output generated.</p>
</div>
<h2>How to synchronize data access</h2>
<p>To solve the problem we found in the previous examples, we have to be
sure that no two threads try to write at the same time to the same
variable. For that, we can use a <code>Lock</code>:</p>
<pre><code class="language-python">from threading import Lock
[...]
data_lock = Lock()
def modify_variable(var):
    while True:
        for i in range(len(var)):
            with data_lock:
                var[i] += 1
        if event.is_set():
            break
        # sleep(.5)
    print('Stop printing')
</code></pre>
<p>Note that we added a line <code>with data_lock:</code> to the function. If you run
the code again, you will see that the values we get are always
consecutive. The lock guarantees that only one thread will access the
variable at a time.</p>
<p>The examples of increasing or decreasing values from a list are almost
trivial, but they point in the direction of understanding the
complications of memory management when dealing with concurrent
programming. Memory sharing is a nice feature, but it comes with risks
also.</p>
<h2>Queues</h2>
<p>One of the common situations in which threads are used is when you have
some slow tasks that you can't optimize. For example, imagine you are
downloading data from a website using. Most of the time the processor
would be idle. This means you could use that time for something else. If
you want to download an entire website (also called scraping), it would
be a good solution to download several pages at the same time. Imagine
you have a list of pages you want to download, and you start several
threads, each one to download one page. If you are not careful on how to
implement this, you may end up downloading twice the same, as we saw in
the previous section.</p>
<p>Here is where another object can be very useful when working with
threads: <strong>Queues</strong>. A queue is an object which accepts data in order,
i.e. you put data to it one element at a time. Then, the data can be
consumed in the same order, called First-in-first-out (FIFO). A very
simple example would be:</p>
<pre><code class="language-python">from queue import Queue

queue = Queue()
for i in range(20):
    queue.put(i)

while not queue.empty():
    data = queue.get()
    print(data)
</code></pre>
<p>In this example you see that we create a <code>Queue</code>, then we put into the
queue the numbers from 0 to 19. Later, we create a <code>while</code> loop that
gets data out of the queue and prints it. This is the basic behavior of
queues in Python. You should pay attention to the fact that numbers are
printed in the same order in which they were added to the queue.</p>
<p>Coming back to the examples from the beginning of the article, we can
use queues to share information between threads. We can modify the
function such that instead of a list as an argument, it accepts a queue
from which it will read elements. Then, it will output the results to an
output queue:</p>
<pre><code class="language-python">from threading import Thread, Event
from queue import Queue
from time import sleep, time

event = Event()

def modify_variable(queue_in, queue_out):
    while True:
        if not queue_in.empty():
            var = queue_in.get()
            for i in range(len(var)):
                var[i] += 1
            queue_out.put(var)
        if event.is_set():
            break
    print('Stop printing')
</code></pre>
<p>To use the code above, we will need to create two queues. The idea is
that we can also create two threads, in which the input and output queue
are reversed. In that case, on thread puts its output on the queue of
the second thread and the other way around. This would look like the
following:</p>
<pre><code class="language-python">my_var = [1, 2, 3]
queue1 = Queue()
queue2 = Queue()
queue1.put(my_var)
t = Thread(target=modify_variable, args=(queue1, queue2))
t2 = Thread(target=modify_variable, args=(queue2, queue1))
t.start()
t2.start()
t0 = time()
while time()-t0 &lt; 5:
    try:
        sleep(1)
    except KeyboardInterrupt:
        event.set()
        break
event.set()
t.join()
t2.join()
if not queue1.empty():
    print(queue1.get())
if not queue2.empty():
    print(queue2.get())
</code></pre>
<p>In my case, the output I get is:</p>
<pre><code class="language-python">[871, 872, 873]
</code></pre>
<p>Much smaller than everything else we have seen so far, but at least we
managed to shared data between two different threads, without any
conflicts. Where does this slow speed come from? Let's try with the
scientific approach which is to split the problem and look at each part.
One of the most interesting things is that we are checking whether the
queue is empty before trying to run the rest of the code. We can monitor
how much time it is actually spent running the important part of our
program:</p>
<pre><code class="language-python">def modify_variable(queue_in: Queue, queue_out: Queue):
    internal_t = 0
    while True:
        if not queue_in.empty():
            t0 = time()
            var = queue_in.get()
            for i in range(len(var)):
                var[i] += 1
            queue_out.put(var)
            internal_t += time()-t0
        if event.is_set():
            break
    sleep(0.1)
    print(f'Running time: {internal_t} seconds\n')
</code></pre>
<p>The only changes are the addition of a new variable in the function,
called <code>internal_t</code>. Then, we monitor the time spent calculating and
putting to the new thread. If we run the code again, the output you
should get is something like:</p>
<pre><code class="language-python">Running time: 0.0006377696990966797 seconds
Running time: 0.0003573894500732422 seconds
</code></pre>
<p>This means that out of the 5 seconds in which our program runs, only
during about .9 milliseconds we are actually doing something. This is
.01% of the time! Let's quickly see what happens if we change the code
for using only one queue instead of two, i.e. the input and output queue
would be the same:</p>
<pre><code class="language-python">t = Thread(target=modify_variable, args=(queue1, queue1))
t2 = Thread(target=modify_variable, args=(queue1, queue1))
</code></pre>
<p>With just that change, I've got the following output:</p>
<pre><code class="language-python">Running time: 4.290639877319336 seconds
Running time: 4.355865955352783 seconds
</code></pre>
<p>That is much better! For the about of 5 seconds in which the program
runs, the threads run for a total of 8 seconds. Which is what one would
expect of parallelizing. Also, the output of the loops is much larger:</p>
<pre><code class="language-python">[710779, 710780, 710781]
</code></pre>
<p>Can you try to guess what made our program so slow if we use two queues
but reasonably fast if we use the same queue for output and input? You
have to remember that when you use threads <em>blindly</em> as we have done in
the previous example, we leave everything in the hands of the operating
system.</p>
<p>We have no control of whether the OS decides to switch from a task to
another. In the code above, we check whether the queue is empty. It may
very well be that the operating system decides to give priority to a
task which is basically not doing anything, but waiting until there is
an element in the queue. If this happens out of synchronization, most of
the time the program will be just waiting to have an element in the
queue (it is always prioritizing the wrong task). While when we use the
same task for input and output, it doesn't matter which task it runs,
there will always be something to proceed.</p>
<p>If you want to see whether the previous speculation is true or not, we
can measure it. We have only one <code>if</code> statement to check
<code>queue.empty()</code>, we can add an <code>else</code> to accumulate the time the program
is actually not doing anything:</p>
<pre><code class="language-python">def modify_variable(queue_in: Queue, queue_out: Queue):
    internal_t = 0
    sleeping_t = 0
    while True:
        if not queue_in.empty():
            t0 = time()
            var = queue_in.get()
            for i in range(len(var)):
                var[i] += 1
            queue_out.put(var)
            internal_t += time()-t0
        else:
            t0 = time()
            sleep(0.001)
            sleeping_t += time()-t0
        if event.is_set():
            break
    sleep(0.1)
    print(f'Running time: {internal_t} seconds')
    print(f'Sleeping time: {sleeping_t} seconds')
</code></pre>
<p>In the code above, if the queue is empty, the program will sleep for 1
millisecond. Of course, this is not the best, but we can assume that 1
millisecond will have no real impact on the overall performance of the
program. When I run the program above, using two different queues I get
the following output:</p>
<pre><code class="language-bash">Running time: 0.0 seconds
Sleeping time: 5.001126289367676 seconds
Running time: 0.00018215179443359375 seconds
Sleeping time: 5.001835107803345 seconds
[4126, 4127, 4128]
</code></pre>
<p>Where it is clear that most of the time the program is just waiting
until more data is available on the queue. Since we are sleeping for 1
ms every time there is no data available, we are actually making the
program much slower. But I think it is a good example. We can compare it
with using the same queue for input and output:</p>
<pre><code class="language-bash">Running time: 3.1206254959106445 seconds
Sleeping time: 1.3756272792816162 seconds
Running time: 3.253162145614624 seconds
Sleeping time: 1.136244535446167 seconds
</code></pre>
<p>Now you see that even if we are wasting some time because of the sleep,
most of the time our routine is actually performing a calculation.</p>
<p>The only thing you have to be careful when using the same queue for
input and output is that between checking whether the queue is empty and
actually reading from it, it could happen that the other thread grabbed
the result. This is described in the <a href="https://docs.python.org/3/library/queue.html#queue.Queue.empty">Queue
documentation</a>.
Unless we include a <code>Lock</code> ourselves, the Queue can be read and written
by any threads. The Lock only comes into effect for the <code>get</code> or <code>put</code>
commands.</p>
<h2>Extra Options of Queues</h2>
<p>Queues have some extra options, such as the maximum number of elements
they can hold. You can also define <strong>LIFO</strong> (last-in, first-out) types
of queues, which you can read about <a href="https://docs.python.org/3/library/queue.html#module-queue">in the
documentation</a>.
What I find more useful about <code>Queues</code> is that they are written in pure
Python. If you visit their <a href="https://github.com/python/cpython/blob/3.7/Lib/queue.py">source
code</a>, you can
learn a lot about synchronization in threads, <a href="http://localhost:8000/blog/learning-not-to-handle-exceptions">custom
exceptions</a>, and
<a href="http://localhost:8000/blog/documenting-with-sphinx-and-readthedocs">documenting</a>.</p>
<p>What is important to note, is that when you work with multiple Threads,
sometimes you want to wait (i.e. block the execution), sometimes you
don't. In the examples above, we have always been checking whether the
Queue was empty before reading from it. But what happens if we don't
check it? The method <code>get</code> has two options: <code>block</code> and <code>timeout</code>. The
first is used to determine whether we want the program to wait until an
element is available. The second is to specify the number of seconds we
want it to wait. After that amount of time, an exception is raised. If
we set <code>block</code> to false, and the queue is empty, the exception is raised
immediately.</p>
<p>We can change the function <code>modify_variable</code> to take advantage of this:</p>
<pre><code class="language-python">def modify_variable(queue_in: Queue, queue_out: Queue):
    internal_t = 0
    while True:
        t0 = time()
        var = queue_in.get()
        for i in range(len(var)):
            var[i] += 1
        queue_out.put(var)
        internal_t += time()-t0
        if event.is_set():
            break
    sleep(0.1)
    print(f'Running time: {internal_t} seconds\n')
</code></pre>
<p>With this code, using different queues for input and output, I get the
following:</p>
<pre><code class="language-bash">Running time: 4.914130210876465 seconds
Running time: 4.937211513519287 seconds

[179992, 179993, 179994]
</code></pre>
<p>Which is much better than what we were getting before. But, this is not
really fair. A lot of time is spent just waiting in the <code>get</code> function,
but we are still counting that time. If we move the line of
<code>t0 = time()</code> right below the <code>get</code>, the times the code is actually
running are very different:</p>
<pre><code class="language-bash">Running time: 0.7706246376037598 seconds
Running time: 0.763786792755127 seconds

[177807, 177808, 177809]
</code></pre>
<p>So now you see, perhaps we should have calculated the time differently
also in the previous examples, especially when we were using the same
queue for input and output.</p>
<p>If we don't want to program to block while waiting for a get, we can do
the following:</p>
<pre><code class="language-python">from queue import Empty
[...]

    try:
        var = queue_in.get(block=False)
    except Empty:
        continue
</code></pre>
<p>Or, we could specify a timeout, like this:</p>
<pre><code class="language-python">try:
    var = queue_in.get(block=True, timeout=0.001)
except Empty:
    continue
</code></pre>
<p>In that case, we either don't wait (<code>block==False</code>) and we catch the
exception, or we wait for up to 1 millisecond (<code>timeout=0.001</code>) and we
catch the exception. You can play around with these options to see if
the performance of your code changes in any way.</p>
<h2>Queues to Stop Threads</h2>
<p>Up to now, we have always used locks to stop threads, which is, I
believe, a very elegant way of doing it. However, there is another
possibility, which is to control the flow of threads by appending
special information to queues. A very simple example would be to add an
element <code>None</code> to a queue, and when the function gets it, it stops the
execution. The code would look like this:</p>
<pre><code class="language-python">[...]

var = queue_in.get()
if var is None:
    break
</code></pre>
<p>And then, in the main part of the script, when we want to stop the
threads, we do the following:</p>
<pre><code class="language-python">queue1.put(None)
queue2.put(None)
</code></pre>
<p>If you are wondering why you would choose one or the other option, the
answer is actually quite straightforward. The examples we are working
with, always have queues with 1 element at most. When we stop the
program, we know everything in the queue has been processed. Imagine,
however, that the program is processing a collection of elements, with
no relation between each other. This would be the case if you would be
downloading data from a website, for example, or processing images, etc.
You want to be sure you finish processing everything before stopping the
thread. In such a case, adding a special value to the queue guarantees
that all elements will be processed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>it is a very wise idea to be sure a queue is empty after you stop using
it. If, as before, you interrupt the thread by looking at the status of
a lock, the queue may be left with a lot of data in it, and thus the
memory will not be freed. A simple while-loop that gets all the elements
of a queue solves it.</p>
</div>
<h2>IO Bound threads</h2>
<p>The examples in this article are computationally intensive, and thus
they are right on the edge where using multi-threading is not applicable
and where all the problems arise (such as concurrency, etc.) We have
focused on the limits of multi-threading because if you understand them,
you will program with much more confidence. You won't be on your toes
hoping for a problem not to arise.</p>
<p>An area where multi-threading excels is in IO (input-output) tasks. For
example, if you have a program which writes to the hard drive while it
is doing something else, the writing to the hard drive can be safely
offloaded to a separate thread, while the rest of the program keeps
running. This is also valid if the program waits for user input or
network resources to become available, downloads data from the internet,
etc.</p>
<h3>Example downloading websites</h3>
<p>To close this article, let's see an example of downloading websites
using threadings, queues, and locks. Even if some performance
improvements are possible, the example will show the basic building
blocks of almost any threading application of interest.</p>
<p>First, let's discuss what we want to achieve. To keep the example
simple, we will download all the websites on a list, and we want to save
the downloaded information to the hard drive. The first approach would
be to create a for-loop that goes through the list. This code can be
found <a href="https://github.com/PFTL/website/blob/master/example_code/32_threads_data/AI_download_data.py">on the Github
repository</a>.
However, we would like to work with multiple threads.</p>
<p>The architecture we propose therefore is: One Queue that hosts the
websites we want to download, one queue that hosts the data to be saved.
Some threads going to the websites to download, and each one outputs the
data to the other queue. Some threads which read the latter queue and
save the data to disk, taking care of not overwriting files. The modules
we are going to use for this example are:</p>
<pre><code class="language-python">import os
from queue import Queue
from threading import Lock, Thread
from urllib import request
</code></pre>
<p>Note that we are using urllib to downloading data. We then create the
queues and the lock we are going to use:</p>
<pre><code class="language-python">website_queue = Queue()
data_queue = Queue()
file_lock = Lock()
</code></pre>
<p>Now we can proceed to define the functions which will run on separated
threads. For downloading data:</p>
<pre><code class="language-python">def download_data():
    while True:
        var = website_queue.get()
        if var is None:
            break
        response = request.urlopen(var)
        data = response.read()
        data_queue.put(data)
</code></pre>
<p>Here you see that we used the strategy of checking whether the queue has
a special element, to be sure that we processed all the websites on the
queue before stopping the thread. We download the data from the website
and we put it on another queue to be later processed.</p>
<p>The saving requires a bit more care because we have to be sure that no
two threads try to write to the same file:</p>
<pre><code class="language-python">def save_data():
    while True:
        var = data_queue.get()
        if var is None:
            break
        with file_lock:
            i = 0
            while os.path.exists(f'website_data_{i}.dat'):
                i += 1
            open(f'website_data_{i}.dat', 'w').close()
        with open(f'website_data_{i}.dat', 'wb') as f:
            f.write(var)
</code></pre>
<p>The approach is similar to the downloading of data. We wait until a
special element is present to stop the thread. Then we acquire a lock to
be sure no other thread is looking at the available files to write to.
The loop just checks which file number is available. We have to use a
lock here because there is a change two threads run the same lines at
the same time and find the available file to be the same.</p>
<p>When we write to the file, we don't care about the lock, because we know
that only one thread will write to each file. That is why we create the
file on one line, while the lock is acquired:</p>
<pre><code class="language-python">open(f'website_data_{i}.dat', 'w').close()
</code></pre>
<p>But we write the data on a separate line, without the lock:</p>
<pre><code class="language-python">with open(f'website_data_{i}.dat', 'wb') as f:
    f.write(var)
</code></pre>
<p>This may seem too convoluted for our purposes, and it is true. However,
it shows one possible approach in which several threads could be writing
to the hard drive at the same time because they are writing to different
files. Note that we have used <code>wb</code> for the opening of the file. The <code>w</code>
is because we want to write to the file (not append), and the <code>b</code>
because the result of reading the <code>response</code> is binary and not a string.
Then, we need to trigger the threads we want to download and save the
data. First, we create a list of websites we want to download. In this
case, Wikipedia homepages in different languages:</p>
<pre><code class="language-python">website_list = [
    'https://www.wikipedia.org/',
    'https://nl.wikipedia.org/',
    'https://de.wikipedia.org/',
    'https://fr.wikipedia.org/',
    'https://pt.wikipedia.org/',
    'https://it.wikipedia.org',
    'https://ru.wikipedia.org',
    'https://es.wikipedia.org',
    'https://en.wikipedia.org',
    'https://ja.wikipedia.org',
    'https://zh.wikipedia.org',
]
</code></pre>
<p>And then we prepare the queues and trigger the threads:</p>
<pre><code class="language-python">for ws in website_list:
    website_queue.put(ws)

threads_download = []
threads_save = []
for i in range(3):
    t = Thread(target=download_data)
    t.start()
    threads_download.append(t)
    t2 = Thread(target=save_data)
    t2.start()
    threads_save.append(t2)
</code></pre>
<p>With this, we create lists with the threads running for saving and
downloading. Of course, the numbers could have been different. Then, we
need to be sure we stop the downloading threads:</p>
<pre><code class="language-python">for i in range(3):
    website_queue.put(None)
</code></pre>
<p>Since we run 3 threads for downloading data, we have to be sure we
append 3 <code>None</code> to the Queue, or some thread won't stop. After we are
sure the downloading finished, we can stop the saving:</p>
<pre><code class="language-python">for t in threads_download:
    t.join()

for i in range(3):
    data_queue.put(None)
</code></pre>
<p>And then we wait for the saving to finish:</p>
<pre><code class="language-python">for t in threads_save:
    t.join()
print(f'Finished downloading {len(website_list)} websites')
</code></pre>
<p>Now we know all the threads have finished and the queues are empty. If
you run the program, you can see the list of 10 files created, with the
HTML of 10 different Wikipedia homepages.</p>
<h2>Conclusions</h2>
<p>In the <a href="http://localhost:8000/blog/starting-and-synchronizing-threads">previous article</a>, we have
seen how you can use threading to run different functions at the same
time, and some of the most useful tools you have available to control
the flow of different threads. In this article we have discussed how you
can share data between threads, exploiting both the fact of the shared
memory between threads and by using queues.</p>
<p>Having access to shared memory makes programs very quick to develop, but
they can give rise to problems when different threads are
reading/writing to the same elements. This was discussed at the
beginning of the article, in which we explored what happens when using a
simple operator such as <code>=+</code> to increase the values of an array by 1.
Then we explored how to use Queues to share data between threads, both
between the main thread and child threads as between child threads.</p>
<p>To finish, we have shown a very simple example of how to use threads to
download data from a website and save it to disk. The example is very
basic, but we will expand it in the following article. Other IO
(input-output) tasks that can be explored are <a href="http://localhost:8000/blog/step-by-step-guide-to-building-a-gui">acquisition from
devices</a> such as a camera, waiting
for user input, <a href="http://localhost:8000/blog/introduction-to-storing-data-in-files">reading from disk</a>,
etc.</p>
<p>Header Illustration by <a href="https://dribbble.com/tsvety-designs">Tsvetelina
Stoynova</a></p>
        </main>
      </div>
      <div class="flex border-t text-lg px-4 pt-6 lg:pt-12 lg:mb-12">
        <div
            class="before:inset-y-1/2 before:inset-x-1 before:content-article before:h-6 before:w-6 before:inline-block before:align-middle"></div>
        <div class="pl-8 text-gray-600 font-light">Article written by Aquiles Carattino</div>
      </div>

      <div class="pt-4 pb-6 md:px-4 border-t border-gray-200 justify-center">
        <div class="bg-gray-300 font-serif text-2xl md:text-4xl text-center md:p-6 p-2">Join our newsletter!</div>
        <div class="py-4">If you liked the content, sign up to never miss an update.
        </div>
        <div id="mc_embed_signup" class="">
          <form
              action="https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&amp;id=8a0ca536e8&amp;f_id=00dfebe6f0"
              method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form"
              class="validate my-3 md:flex md:max-w-lg"
              target="_self" novalidate="">
            <div class="field-wp">
              <input type="email" name="EMAIL" placeholder="Your E-Mail" id="mce-EMAIL" required=""
                     value=""
                     class="required email bg-gray-100 ring-red-500 p-4 w-full md:max-w-2/3">
            </div>
            <div id="mce-responses" class="clear foot">
              <div class="response" id="mce-error-response" style="display: none;"></div>
              <div class="response" id="mce-success-response" style="display: none;"></div>
            </div>
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
              /* real people should not fill this in and expect good things - do not remove this or risk
              form
              bot
              signups */
              <input type="text" name="b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8" tabindex="-1" value="">
            </div>
            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
                   class="bg-emerald-500 hover:scale-105 w-full focus:bg-emerald-300 text-white p-4 mt-2 md:ml-4 md:mt-0 md:w-40">
          </form>
        </div>
      </div>

        <div class="lg:mt-6">
          <h2 class="font-serif font-semibold text-2xl leading-tight">Related Articles</h2>
          <div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="http://localhost:8000/blog/starting-and-synchronizing-threads" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/synchronizing_threads.png"
                           alt="Illustration of Starting and Synchronizing Threads">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2019-08-06</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">Starting and Synchronizing Threads</h3>
                      <div class="font-sans ">If you have developed code for long enough, probably you have faced the situation in which a task takes longer to complete and in the meantime, your program can't perform any other task. Most likely you can't even politely cancel what the program is doing, you will have to resort </div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="http://localhost:8000/blog/how-to-use-hdf5-files-in-python" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/storing_data_hdf.png"
                           alt="Illustration of How to use HDF5 files in Python">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2018-03-19</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">How to use HDF5 files in Python</h3>
                      <div class="font-sans ">When dealing with large amounts of data, either experimental or simulated, saving it to several text files is not very efficient. Sometimes you need to access a specific subset of the dataset, and you don't want to load it all to memory. If you are looking for a solution that </div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
              <div class="group border-b border-b-gray-400 mb-4">
                <a href="http://localhost:8000/blog/data-descriptors-bringing-attributes-next-level" class="text-gray-700 hover:text-gray-900">
                  <div class="sm:flex">
                    <div class="flex-none sm:w-64 md:w-96">
                      <img class="px-2 pb-4" src="/images/42_decorators.width-800.png"
                           alt="Illustration of Data Descriptors: Bringing Attributes to the Next level">
                    </div>
                    <div class="px-4 sm:flex-auto">
                      <div class="text-gray-600 text-xs p-0.5">2020-05-16</div>
                      <h3 class="font-serif leading-tight text-lg font-semibold pb-2">Data Descriptors: Bringing Attributes to the Next level</h3>
                      <div class="font-sans ">Descriptors in Python allow us to control how attributes of classes are accessed or modified. A pattern often encountered is defining properties to use setter and getter methods encapsulated as if they were a single attribute. In this article, we will dig into how the property decorator works, to understand </div>
                      <div class="p-2 inline-block font-sm"><span
                          class="after:transition-all after:ease-in-out hover:after:translate-x-2.5 after:inline-block after:translate-x-1.5 after:w-5 group-hover:after:content-arrowBlue">Read more</span>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
          </div>
        </div>
      <div class="px-2 lg:text-center lg:mt-8">
        <h4 class="text-2xl leading-tight lg:mx-auto lg:text-4xl">Share your thoughts with us!</h4>
        <div class="comments">
          <!-- Comment -->
          <script src="https://utteranc.es/client.js"
                  repo="PFTL/pftl_discussions"
                  issue-term="pathname"
                  label="Comment"
                  theme="github-light"
                  crossorigin="anonymous"
                  async>
          </script>
        </div>
      </div>
    </div>
    <div id="col-right" class="lg:w-72">
      <div class="bg-gray-300 place-items-center mt-3 p-6">
        <h3 class="font-serif text-2xl text-center mb-2 font-semibold mx-auto lg:text-xl">Support Us</h3>
        <p class="font-serif lg:text-sm leading-tight mb-2">If you like the content of this website, consider buying a
          copy of
          the book
          <strong>Python For The
            Lab</strong></p>
        <a href="http://localhost:8000/books">
          <button class="bg-emerald-500 hover:scale-105 focus:bg-emerald-300 text-white p-4 mt-2 w-full md:max-w-2/3">
            Check out the books
          </button>
        </a>
      </div>

      <div class="mt-3 border border-gray-400  place-items-center">
          <h3 class="bg-gray-300 font-serif text-2xl text-center py-4">Parallelizing series</h3>
          <ol class="mt-4">
              <li class="mx-4 p-3 border-b border-b-gray-400 ">
                <a href="http://localhost:8000/blog/implementing-threads-for-measurements" class="font-lg leading-tight hover:font-bold">
                  <div>Implementing Threads for Measurements</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2018-05-29</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400 border-b-2 border-b-emerald-400 ">
                <a href="http://localhost:8000/blog/handling-and-sharing-data-between-threads" class="font-lg leading-tight hover:font-bold">
                  <div>Handling and Sharing Data Between Threads</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2019-08-06</div>
                </a>
              </li>
              <li class="mx-4 p-3 border-b border-b-gray-400 ">
                <a href="http://localhost:8000/blog/starting-and-synchronizing-threads" class="font-lg leading-tight hover:font-bold">
                  <div>Starting and Synchronizing Threads</div>
                  <div class="font-light text-gray-600 text-sm">
                    by Aquiles Carattino, 2019-08-06</div>
                </a>
              </li>
          </ol>
      </div>
    </div>
  </div>


<!-- Footer -->
<footer class="w-full bg-black text-white p-8">
  <div class="flex flex-row flex-wrap items-center justify-center gap-y-6 gap-x-12 text-center md:justify-between">
    <img src="http://localhost:8000/theme/css/images/logo-red.svg" alt="logo-ct" class="w-20" />
    <ul class="flex flex-wrap items-center gap-y-2 gap-x-8">
      <li>
        <a
          href="http://localhost:8000/about"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          About Us
        </a>
      </li>
      <li>
        <a
          href="http://localhost:8000/cookie-policy"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Cookie Policy
        </a>
      </li>
      <li>
        <a
          href="http://localhost:8000/privacy-policy"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Privacy Policy
        </a>
      </li>
      <li>
        <a
          href="http://localhost:8000/contact-us"
          class="block font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased transition-colors hover:text-pink-500 focus:text-pink-500"
        >
          Contact Us
        </a>
      </li>
    </ul>
  </div>
  <hr class="my-8 border-blue-gray-50" />
  <p class="block text-center font-sans text-base font-normal leading-relaxed text-blue-gray-200 antialiased">
     2023 Python for the Lab
  </p>
</footer><script src="http://localhost:8000/theme/js/prism.js"></script>
<script src="https://files.stork-search.net/releases/v1.5.0/stork.js"></script>
<script>
    stork.register("sitesearch", "http://localhost:8000/search-index.st");
</script>

<script>
    $(document).ready(function () {
        responsive_menu = $('#menu');
        nav = $('nav');
        $('#menu-button').on('click', function (e) {
            e.preventDefault();
            if (responsive_menu.is(':hidden')) {
                responsive_menu.slideToggle();
                nav.addClass('bg-white');
                $("#site-logo").attr("src", "http://localhost:8000/theme/css/images/logo-classic.svg");
                $('hamburger').slideToggle();
                $('#hamburger').attr('src', 'http://localhost:8000/theme/css/images/cross.svg');
            } else {
                responsive_menu.slideToggle();
                nav.removeClass('bg-white');
                $("#site-logo").attr("src", "http://localhost:8000/theme/css/images/logo-red.svg");
                $('#hamburger').attr('src', 'http://localhost:8000/theme/css/images/hamburger.svg');
            }
        });
        position = $(window).height();
        $(window).scroll(function () {
            var currentScroll = $(window).scrollTop();
            if (currentScroll >= position) {
                $('#sticky_menu').addClass('lg:block');
            } else {
                $('#sticky_menu').removeClass('lg:block');
            }
        });
    });
</script></body>
</html>