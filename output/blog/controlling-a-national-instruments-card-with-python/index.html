<!doctype html><html lang=en><script async src=https://www.googletagmanager.com/gtag/js?id=G-CYPVPEJ4PK></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-CYPVPEJ4PK')</script><meta charset=utf-8><meta content=width=device-width,initial-scale=1 name=viewport><title>Controlling a National Instruments Card with Python | Python For The Lab</title><meta content="National Instruments, DAQ, Control, NI DAQ, PyDAQmx, " name=tags><meta content="Don't depend on Labview; learn how to control National Instruments cards
directly with Python.
" name=description><meta content="Aquiles Carattino" name=author><link href=blog/controlling-a-national-instruments-card-with-python rel=canonical><meta content="Python for the Lab" property=og:site_name><meta content=article property=og:type><meta content=blog/controlling-a-national-instruments-card-with-python property=og:url><meta content="Controlling a National Instruments Card with Python" property=og:title><meta content="Don't depend on Labview; learn how to control National Instruments cards
directly with Python.
" property=og:description><meta content=/images/writing-machine_linkedin.width-800.jpg property=og:image><meta content=summary_large_image property=twitter:card><meta content=blog/controlling-a-national-instruments-card-with-python property=twitter:url><meta content="Controlling a National Instruments Card with Python" property=twitter:title><meta content="Don't depend on Labview; learn how to control National Instruments cards
directly with Python.
" property=twitter:description><meta content=/images/writing-machine_linkedin.width-800.jpg property=twitter:image><meta content=@aquicarattino name=twitter:creator><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-57x57.png rel=apple-touch-icon sizes=57x57><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-72x72.png rel=apple-touch-icon sizes=72x72><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-114x114.png rel=apple-touch-icon sizes=114x114><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-144x144.png rel=apple-touch-icon sizes=144x144><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=https://pythonforthelab.com/theme/css/favicon/apple-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=https://pythonforthelab.com/theme/css/favicon/android-icon-192x192.png rel=icon sizes=192x192 type=image/png><link href=https://pythonforthelab.com/theme/css/favicon/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://pythonforthelab.com/theme/css/favicon/favicon-96x96.png rel=icon sizes=96x96 type=image/png><link href=https://pythonforthelab.com/theme/css/favicon/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=https://pythonforthelab.com/theme/css/favicon/manifest.json rel=manifest><meta content=#ffffff name=msapplication-TileColor><meta content=https://pythonforthelab.com/theme/css/favicon/ms-icon-144x144.png name=msapplication-TileImage><meta content=#ffffff name=theme-color><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;700&display=swap rel=stylesheet><link href=https://pythonforthelab.com/theme/css/style.css rel=stylesheet><link href=https://files.stork-search.net/basic.css rel=stylesheet><link href=https://https://pythonforthelab.com/feed.rss rel=alternate title=RSS type=application/rss+xml><script src=https://code.jquery.com/jquery-3.4.1.min.js></script><script src=https://pythonforthelab.com/theme/js/jquery-migrate-1.2.1.js></script><script src=https://pythonforthelab.com/theme/js/functions.js></script><link href=https://pythonforthelab.com/theme/css/prism.css rel=stylesheet><body><section class=wrapper><div class="intro blog article"><div class=container><div class=header><a class=logo href=/>Python for the Lab</a><div class=header-dd><div class=navigation><ul><li class=active><a class="nav-item blog" href=https://pythonforthelab.com/blog><span>Blog</span></a><li><a class="nav-item courses" href=https://pythonforthelab.com/courses/><span>Courses</span></a><li><a class="nav-item hire-me" href=https://pythonforthelab.com/hire-me/><span>Hire Me</span></a><li><a class="nav-item forum" href=https://github.com/PFTL/pftl_discussions/discussions target=_blank><span>Forum</span></a><li><a class="nav-item books" href=https://pythonforthelab.com/books><span>Books</span></a><li><a class="nav-item about" href=https://pythonforthelab.com/about><span>About</span></a></ul></div><div class="search field-wp"><form action=#><input placeholder="Type to Search" class=field data-stork=sitesearch><input class=search-btn type=submit></form><div data-stork=sitesearch-output></div></div></div><button class=menu-btn><span>Menu</span></button></div><div class="intro-cnt v-article"><div class=side-text></div><div class="side-form small-sb-form"><div class=sb-form id=mc_embed_signup><h4>Get all the information directly to your inbox</h4><form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup_scroll><input placeholder="Your E-Mail" class=field id=mce-EMAIL name=EMAIL required type=email></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit><span class=small-text>Get relevant information, unsubscribe at any time.</span></form></div></div></div></div></div><div class=main><div class=container><div class=article-cnt><div class=leftside><div class=article-image><img alt src=https://pythonforthelab.com//images/writing-machine_linkedin.width-800.jpg width=800></div><h1>Controlling a National Instruments Card with Python</h1><h3>Don't depend on Labview; learn how to control National Instruments cards directly with Python.</h3><div class=info><span class="item-1 author">by Aquiles Carattino</span><span class="item-1 date">2018-02-21</span><span class="item-tag first">National Instruments</span><span class=item-tag>DAQ</span><span class=item-tag>Control</span><span class=item-tag>NI DAQ</span><span class=item-tag>PyDAQmx</span></div><main><p>One of the most common devices in a lab is a National Instruments acquisition card, also called a DAQ. As you probably know by now, the default programming environment for such cards is Lab View, but what you may not be aware is that there are libraries for interfacing with other languages. NI provides a common driver to all of their devices called <em>NI-DAQmx</em> and how to use their hardware through the C programming language is <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/>well documented</a>.<p>Once there is good documentation for one programming language, there are no limits for developers to expand the toolbox into other languages. For National Instruments devices, there is a project called <a href=https://pythonhosted.org/PyDAQmx/>PyDAQmx</a> that ported all the functions to be Python compatible. Since it is a port of the C code, what you should always bear in mind is that you have to check the <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/>National Instruments documentation</a> and adapt the code to Python.<div class="admonition note"><p class=admonition-title>Note<p>Since the writing of this article, a new Python package supporting NI-DAQmx was released by National Instruments itself. You can see the <a href=https://nidaqmx-python.readthedocs.io/en/latest/>documentation here</a>. I didn't have time to test it yet, but looks very promising. Keep an eye on the <a href=https://github.com/ni/nidaqmx-python/issues>bugs and issues</a> because they may be a good source of information.</div><p>Let's see how to get started. Remember that each card has different specifications and therefore some of the options may not be present in your current configuration. Let's assume we want to read an analog input from our device; you need to know the number that was assigned to your card in order to communicate with it; normally you should have National Instruments software that allows you to configure the number of your card.<pre><code class=language-python>import PyDAQmx as nidaq


t = nidaq.Task()
t.CreateAIVoltageChan("Dev1/ai0", None, nidaq.DAQmx_Val_Diff, 0, 10, nidaq.DAQmx_Val_Volts, None)
t.CfgSampClkTiming("", 1000, nidaq.DAQmx_Val_Rising, nidaq.DAQmx_Val_FiniteSamps, 5000)
t.StartTask()
</code></pre><p>In these few lines of code we have created a new Task and called it <code>t</code>; we have defined an analog input channel for <code>Dev1</code> and port number <code>ai0</code>. We also configured the timing to be internal, with 1000 samples per second and in total, we want to acquire 5000 samples. We finally trigger the task to start acquiring samples. It is interesting to compare our code to what is documented, so you can learn how to adapt the code to Python.<p>We first go to the documentation of the method <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/daqmxcfunc/daqmxcreateaivoltagechan/>CreateAIVoltageChan</a> and the first thing you should notice is that the name is actually different; it is <strong>DAQmxCreateAIVoltageChan</strong>. The first thing to note is that the <em>DAQmx</em> prefix is dropped in PyDAQmx. Then we can see the arguments that the function takes:<pre><code class=language-c>int32 DAQmxCreateAIVoltageChan (
   TaskHandle taskHandle,
   const char physicalChannel[],
   const char nameToAssignToChannel[],
   int32 terminalConfig,
   float64 minVal,
   float64 maxVal,
   int32 units,
   const char customScaleName[]);
</code></pre><p>Since we are using the task as Python object, we drop the first argument of the function; PyDAQmx takes care of it (notice that we are using the syntax <code>t.CreateAIVoltageChan</code>. Then we have to pass all the other arguments, paying attention to their types. So, where it says <code>char</code> we should pass a <code>String</code>; that is what we do for the channel. In this example, we don't assign a name to the channel and therefore we leave it as <code>None</code>. Next, we have to define the <code>terminalConfig</code>; if you look at the documentation, you will see that there are different options, for example <code>DAQmx_Val_RSE</code>, <code>DAQmx_Val_Diff</code>, etc. PyDAQmx has all these configurations already defined and we can use them directly as in the example above: <code>nidaq.DAQmx_Val_Diff</code>.<p>Then it asks for the limits of our analog input; remember that the DAQmx works with units that can be different from volts and that will be defined later on; the limits that we establish here are in those specific units. Setting the limits allows the DAQ card to automatically set a gain to our measurement, therefore increasing the effective resolution of the measurement. The values are automatically converted to the requested type, provided that they are numbers.<p>When performing a measurement with an NI Card we have to explicitly set its units; it may very well be that you have a thermocouple connected to the analog input and therefore you want to measure Kelvins instead of Volts, or that you have any other transducer plugged. Defining custom scales is an entire chapter and therefore it is much easier to leave them here as volts and do the transformation directly in our code. We use again a built-in option of DAQmx, the <code>nidaq.DAQmx_Val_Volts</code> and the last option is left to <code>None</code> because it is what the documentation asks for in case we set the scale to Volts.<div class="admonition note"><p class=admonition-title>Note<p>Converting variable types from Python to C or the other way around is handled in different ways by different libraries. PyDAQmx is doing all the work under to hood and that is why we can use an integer instead of a float, for example. But be aware that it will not always be the same; some libraries require to define very specific types.</div><p>The other method, <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/daqmxcfunc/daqmxcfgsampclktiming/>CfgSampClkTiming</a> is used for configuring the clock used to acquire the samples. I leave it up to you to check the documentation and to understand what each argument of the function is doing. In short, I set it to use an internal clock at a rate of 1000 samples per second for a total of 5000 samples (i.e. 5 seconds total acquisition time). The last line simply triggers the task.<p>The next step is to read the data that was acquired. Remember that it takes 5 seconds for the acquisition to complete; the DAQmx functions are non-blocking, meaning that the execution of your program will not halt at each execution. For reading from the card we will use another method defined within the Task object; you will also need to use numpy for this example to work.<pre><code class=language-python>import numpy as np

[...]

data = np.zeros((5000,), dtype=np.float64)
read = nidaq.int32()
t.ReadAnalogF64(5000, 5, nidaq.DAQmx_Val_GroupByChannel,
   data, len(data), nidaq.byref(read), None)
</code></pre><p>Reading from the NI DAQ has a structure more similar to how proper C code looks like and is quite different from how Python code works. The first thing to note is that there is no return; we are not doing anything like <code>data = t.ReadAnalogF64()</code>. Let's see it step by step. The <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/daqmxcfunc/daqmxreadanalogf64/>documentation</a> is useful but doesn't explain how the actual syntax works. Again, we skip the first argument, the <code>task handler</code> because we are using the object-oriented-style.<p>We define how many data points <em>per channel</em> we want to read; if we were acquiring more than one channel, it is important to notice that it is not the total number of points. We set the timeout in seconds, in order for the function to stop waiting in case there are not enough data points available. Then we set how to group the values in case we are reading from more than one channel. Remember that each channel is read sequentially, so it would be Chan1_1 -> Chan2_1 -> Chan3_1 -> Chan1_2 -> Chan2_2 -> Chan3_2 -> Chan1_3 -> etc. If we group them by channel, they will be returned as all the measurements from Chan1, all the measurements from Chan2, etc. I prefer it this way because it works well with numpy's reshape.<p>Now, the interesting part; we pass as an argument <code>data</code>, which was defined few lines before as an empty numpy array. In the documentation, it is defined as The array to read samples into. This is a very common way of working with functions in C; we first create the memory structure that will hold the output of the function, in this case, a numpy array with 5000 elements. Whatever is present in the array will be overwritten by the read function. The next argument is the actual number of samples read from each channel; in other words, the length of the data array.<p>The final argument is the <code>read</code> integer, that was also defined few lines before. It will hold the total number of data points read per channel. Note that we are not simply passing the read integer as an argument to the function, but we are using a method called <code>byref</code>. This is typical when working with external libraries written in C. It basically means that you are passing the reference to an object and not the object itself; you are letting the function know where in the memory is located that specific variable. In the end, the effect is the same: the variable will hold the information you need.<p>Now you can plot your <code>data</code>, save it or do whatever you like with it. The read function has a lot of options that I haven't fully covered, but that you can easily check the documentation. The complexity arises because the function covers a lot of different scenarios with few inputs. For example, when you are continuously acquiring and you wish to download as many data points as there are available but you cannot know beforehand how many. It can also take care when you use an external trigger and you don't know how long it will take to complete an acquisition.<p>Even though National Instruments cards were not designed to be used with Python, there can still be used in a variety of projects without many complications. The use of a common API for all the cards makes them ideal because exchanging them doesn't require a single change in the code. However, each card can have very different capabilities, for example, the acquisition rate or the number of simultaneous tasks that it can handle.<p>More Information: <a href=https://pythonhosted.org/PyDAQmx/usage.html>PyDAQmx Tutorial</a>, <a href=http://zone.ni.com/reference/en-XX/help/370471AA-01/>NI-DAQmx C Reference Help</a></main><div class=info-list><span class="item author">Article written by Aquiles Carattino</span></div><div class=similar-posts><h3>Related Articles:</h3><ul><li><a class=item href=https://pythonforthelab.com/blog/instructions-to-build-the-python-for-the-lab-daq/> <img alt src=/images/python-arduino-fullsize.width-800.jpg> <span class=date>2021-03-27</span> <span class=name>Instructions to build the Python for the Lab DAQ.</span> </a></ul></div><div class=bottom-section><h4>Share your thoughts with us!</h4><div class=comments><script async crossorigin issue-term=pathname label=Comment repo=PFTL/pftl_discussions src=https://utteranc.es/client.js theme=github-light></script></div></div></div><div class=rightside><div class=support-box><h3>Support Us</h3><p>If you like the content of this website, consider buying a copy of the book <strong>Python For The Lab</strong></p><a class=button href=https://pythonforthelab.com/books>Check out the book</a></div><div class=latest-posts><h3>Latest Articles</h3><ul><li><a href=https://pythonforthelab.com/blog/instructions-to-build-the-python-for-the-lab-daq/>Instructions to build the Python for the Lab DAQ.</a> <span>by Aquiles Carattino, 2021-03-27</span><li><a href=https://pythonforthelab.com/blog/using-slots-in-python-limit-dynamic-attribute-creation-and-improve-speed>Using slots in Python: limit dynamic attribute creation and improve speed</a> <span>by Aquiles Carattino, 2021-03-21</span><li><a href=https://pythonforthelab.com/blog/getting-started-with-basler-cameras>Acquiring images from Basler Cameras</a> <span>by Aquiles Carattino, 2021-02-27</span><li><a href=https://pythonforthelab.com/blog/singletons-instantiate-objects-only-once>Singletons: Instantiate objects only once</a> <span>by Aquiles Carattino, 2021-01-16</span><li><a href=https://pythonforthelab.com/blog/differences-between-multiprocessing-windows-and-linux>Differences of Multiprocessing on Windows and Linux</a> <span>by Aquiles Carattino, 2020-06-13</span><li><a href=https://pythonforthelab.com/blog/python-tip-using-else-loops>Python Tip: Using Else with Loops</a> <span>by Aquiles Carattino, 2020-05-25</span><li><a href=https://pythonforthelab.com/blog/python-tip-ready-publish-matplotlib-figures>Python Tip: Ready to Publish Matplotlib Figures</a> <span>by Aquiles Carattino, 2020-05-18</span><li><a href=https://pythonforthelab.com/blog/data-descriptors-bringing-attributes-next-level>Data Descriptors: Bringing Attributes to the Next level</a> <span>by Aquiles Carattino, 2020-05-16</span><li><a href=https://pythonforthelab.com/blog/python-tips-using-sets>Python Tips: Using Sets</a> <span>by Aquiles Carattino, 2020-05-11</span><li><a href=https://pythonforthelab.com/blog/generators-iterables-iterators-python-when-and-where>Generators, Iterables, Iterators in Python: When and Where</a> <span>by Aquiles Carattino, 2020-04-10</span></ul></div><div class=subscribe-fixed><button class=action>Never Stop Learning</button><div class=cnt><p>Join over 1000 Python developers and don't miss any updates!<form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup><input class="field required email" placeholder="Your E-Mail" id=mce-EMAIL name=EMAIL required type=email></div><div class="clear foot" id=mce-responses><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit></form><p>Or check out our <a href=/books>books</a>! <br> <a href=#>Privacy Policy</a></div></div></div></div><div class=mobile-sb-form><div class=sb-form><h4>Get all the information directly to your inbox</h4><form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup><input class="field required email" placeholder="Your E-Mail" id=mce-EMAIL name=EMAIL required type=email></div><div class="clear foot" id=mce-responses><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit></form></div></div></div></div></section><div class=footer><div class=container><div class=footer-cnt><p class=left>© Python For The Lab <span class=current-year>2023</span><p class=center><a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ rel=license> <img alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png style=border:0></a>.<p class=right><a href=https://pythonforthelab.com/cookie-policy>Cookie Policy</a> <a href=https://pythonforthelab.com/privacy-policy>Privacy Policy</a></div></div></div><script src=https://pythonforthelab.com/theme/js/prism.js></script><script src=https://files.stork-search.net/releases/v1.5.0/stork.js></script><script>stork.register("sitesearch","https://pythonforthelab.com/search-index.st")</script>