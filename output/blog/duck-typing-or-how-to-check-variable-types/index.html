<!doctype html><html lang=en><script async src=https://www.googletagmanager.com/gtag/js?id=G-CYPVPEJ4PK></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-CYPVPEJ4PK')</script><meta charset=utf-8><meta content=width=device-width,initial-scale=1 name=viewport><title>Duck Typing, or how to check variable types | Python For The Lab</title><meta content="functions, methods, dynamic language, typing, types, " name=tags><meta content="What duck typing means how can it affect your program architecture" name=description><meta content="Aquiles Carattino" name=author><link href=blog/duck-typing-or-how-to-check-variable-types rel=canonical><meta content="Python for the Lab" property=og:site_name><meta content=article property=og:type><meta content=blog/duck-typing-or-how-to-check-variable-types property=og:url><meta content="Duck Typing, or how to check variable types" property=og:title><meta content="What duck typing means how can it affect your program architecture" property=og:description><meta content=/images/joshua-coleman-655076-unsplash_linkedin.width-800.jpg property=og:image><meta content=summary_large_image property=twitter:card><meta content=blog/duck-typing-or-how-to-check-variable-types property=twitter:url><meta content="Duck Typing, or how to check variable types" property=twitter:title><meta content="What duck typing means how can it affect your program architecture" property=twitter:description><meta content=/images/joshua-coleman-655076-unsplash_linkedin.width-800.jpg property=twitter:image><meta content=@aquicarattino name=twitter:creator><link href=http://localhost:8000/theme/css/favicon/apple-icon-57x57.png rel=apple-touch-icon sizes=57x57><link href=http://localhost:8000/theme/css/favicon/apple-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=http://localhost:8000/theme/css/favicon/apple-icon-72x72.png rel=apple-touch-icon sizes=72x72><link href=http://localhost:8000/theme/css/favicon/apple-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=http://localhost:8000/theme/css/favicon/apple-icon-114x114.png rel=apple-touch-icon sizes=114x114><link href=http://localhost:8000/theme/css/favicon/apple-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=http://localhost:8000/theme/css/favicon/apple-icon-144x144.png rel=apple-touch-icon sizes=144x144><link href=http://localhost:8000/theme/css/favicon/apple-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=http://localhost:8000/theme/css/favicon/apple-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=http://localhost:8000/theme/css/favicon/android-icon-192x192.png rel=icon sizes=192x192 type=image/png><link href=http://localhost:8000/theme/css/favicon/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=http://localhost:8000/theme/css/favicon/favicon-96x96.png rel=icon sizes=96x96 type=image/png><link href=http://localhost:8000/theme/css/favicon/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=http://localhost:8000/theme/css/favicon/manifest.json rel=manifest><meta content=#ffffff name=msapplication-TileColor><meta content=http://localhost:8000/theme/css/favicon/ms-icon-144x144.png name=msapplication-TileImage><meta content=#ffffff name=theme-color><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;700&display=swap rel=stylesheet><link href=http://localhost:8000/theme/css/style.css rel=stylesheet><link href=https://files.stork-search.net/basic.css rel=stylesheet><link href=https://http://localhost:8000/feed.rss rel=alternate title=RSS type=application/rss+xml><script src=https://code.jquery.com/jquery-3.4.1.min.js></script><script src=http://localhost:8000/theme/js/jquery-migrate-1.2.1.js></script><script src=http://localhost:8000/theme/js/functions.js></script><link href=http://localhost:8000/theme/css/prism.css rel=stylesheet><body><section class=wrapper><div class="intro blog article"><div class=container><div class=header><a class=logo href=/>Python for the Lab</a><div class=header-dd><div class=navigation><ul><li class=active><a class="nav-item blog" href=http://localhost:8000/blog><span>Blog</span></a><li><a class="nav-item hire-me" href=http://localhost:8000/hire-me/><span>Hire Me</span></a><li><a class="nav-item forum" href=https://github.com/PFTL/pftl_discussions/discussions target=_blank><span>Forum</span></a><li><a class="nav-item books" href=http://localhost:8000/books><span>Books</span></a><li><a class="nav-item about" href=http://localhost:8000/about><span>About</span></a></ul></div><div class="search field-wp"><form action=#><input placeholder="Type to Search" class=field data-stork=sitesearch><input class=search-btn type=submit></form><div data-stork=sitesearch-output></div></div></div><button class=menu-btn><span>Menu</span></button></div><div class="intro-cnt v-article"><div class=side-text></div><div class="side-form small-sb-form"><div class=sb-form id=mc_embed_signup><h4>Get all the information directly to your inbox</h4><form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup_scroll><input placeholder="Your E-Mail" class=field id=mce-EMAIL name=EMAIL required type=email></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit><span class=small-text>Get relevant information, unsubscribe at any time.</span></form></div></div></div></div></div><div class=main><div class=container><div class=article-cnt><div class=leftside><div class=article-image><img alt src=http://localhost:8000//images/joshua-coleman-655076-unsplash_linkedin.width-800.jpg width=800></div><h1>Duck Typing, or how to check variable types</h1><h3>What duck typing means how can it affect your program architecture</h3><div class=info><span class="item-1 author">by Aquiles Carattino</span><span class="item-1 date">2019-06-11</span><span class="item-tag first">functions</span><span class=item-tag>methods</span><span class=item-tag>dynamic language</span><span class=item-tag>typing</span><span class=item-tag>types</span></div><main><p>The name duck typing has its root in <a href=https://en.wikipedia.org/wiki/Duck_typing>the expression</a> <em>If it walks like a duck and it quacks like a duck, then it must be a duck</em>. Which means that if you want to know whether you are dealing with a duck or not, you only care about how it looks like and how it behaves rather than actually checking to what species the animal belongs.<p>The code that we develop in this article is available <a href=https://github.com/PFTL/website/tree/master/example_code/33_duck_typing>on Github</a>.<p>The analogy translates <em>almost</em> literally to Python. Python is a dynamically typed language. This means that you don't need to specify what type of variables you are dealing with. The following lines are perfectly valid Python code:<pre><code class=language-python>var1 = 'This is a string'
var1 = 1
</code></pre><p>As you can see above, <code>var1</code> changed from a string to an integer without any problems. We didn't need to specify whether <code>var1</code> was going to be of either type. Without going to the details about what variables truly mean in Python, we can see that it is very convenient because it saves us from a lot of typing. On the other hand, it means that we can't be sure what variable type a function will receive until an error is raised, for example:<pre><code class=language-python>def increase_by_one(value)
    return value + 1
</code></pre><p>If we run the function <code>increase_by_one</code> with <code>var1</code> it will work only if <code>var1</code> is a number (integer or float), but it will give us a <code>TypeError</code> if we run it with a string. Statically typed languages would have warned us about this problem at compilation time and would have prevented us from some headaches down the line.<p>One easy solution would be to check whether the <code>value</code> is either an integer or a float. We can improve our function, like this:<pre><code class=language-python>def increase_by_one(value):
    if isinstance(value, int) or isinstance(value, float):
        return value + 1
</code></pre><p>If we try to run the function with a string, it will not do anything and it will return <code>None</code>. If we run the function with either an integer or a float, it will return the value increased by one. This behavior is more or less what we would expect.<h2>What is duck typing?</h2><p>So, you may wonder after this long preamble, what is actually duck typing. Imagine that we now have a numpy array, and we use the function <code>increase_by_one</code> with it, what do you expect to happen?<pre><code class=language-python>import numpy as np

var1 = np.array((0, 1, 2))
print(increase_by_one(var1))
</code></pre><p>You get <code>None</code>, but is that what you were expecting? If you think about it, we forced the output because we designed the function to only work on integers and floats, while an array is neither of them. However, if we go back to the old version of the function before we implemented the verification, we would get:<pre><code class=language-python>def increase_by_one(value):
    return value + 1

print(increase_by_one(var1))
# [1, 2, 3]
</code></pre><p>You can see that the function <code>increase_by_one</code> works also on arrays. The idea of <strong>duck typing</strong> is that we don't care about what type of variable <code>value</code> is, provided that we can add 1 to it. In Python, this is translated to try to add 1 to <code>value</code> and if an exception is raised, we deal with it:<pre><code class=language-python>def increase_by_one(value):
    try:
        value += 1
    except TypeError:
        return None
    return value
</code></pre><p>Now, the function will run with all types of variables which accept being added by one. At the beginning we assumed only floats and integers were able to be added by one, then we found that numpy arrays are also working, and you can find that there are even more possibilities around.<h2>Custom Classes</h2><p>Duck typing becomes crucial when you develop your custom classes. Python exposes a lot of syntactic sugar which allow you to customize how things behave under certain operations. To keep up with the example above, let's develop a class which allows being increased by one:<pre><code class=language-python>class AddOne:
    def __init__(self, value):
        self.value = str(value)

    def __add__(self, other):
        self.value += str(other)
        return self

    def __str__(self):
        return self.value
</code></pre><p>And we can use it like this:<pre><code class=language-python>var1 = AddOne('0')
print(increase_by_one(var1))
# 01
</code></pre><p>What you see now, is that our class defines the behavior of adding. In this case, the class will concatenate whatever value we add to the initial string that we have defined. That is why we see that the output is <code>01</code>.<p>Duck typing means that our function will run every time there is a way of adding a <code>1</code> to the object. The example in these sections is almost trivial, so we can see something which is much more relevant.<h2>Complex Data Structures</h2><p>When you develop larger programs, it is almost impossible not to need configuration variables. Storing configuration parameters in dictionaries is very handy because it is very explicit. Let's make it very simple:<pre><code class=language-python>configuration = {
    'param1': 10,
    'param2': 5
}
</code></pre><p>And we also develop an Experiment class, which will use the configuration and will verify whether we have supplied all the needed parameters:<pre><code class=language-python>class Experiment:
    def __init__(self, config):
        self.configuration = config

    def check_config(self):
        if not {'param1', 'param2'} <= set(self.configuration.keys()):
            raise Exception('The configuration does not include the mandatory fields')
        print('Config seems OK')
</code></pre><p>You see that we have developed <code>check_config</code> which uses sets to check whether both parameters are within the keys of the dictionary. In other words, we verify whether the set <code>{'param1', 'param2'}</code> is a subset of all the keys in the configuration.<p>We can add one last method to check whether the parameters are within an acceptable range:<pre><code class=language-python>def check_config_range(self):
    if self.configuration['param1'] > 10:
        raise Exception('param1 cannot be larger than 10')
    if self.configuration['param2'] > 5:
        raise Exception('param2 cannot be larger than 5')
    print('Range seems OK')
</code></pre><p>You can test the code by running:<pre><code class=language-python>exp = Experiment(configuration)
exp.check_config()
exp.check_config_range()
</code></pre><p>So, where does duck typing come into effect?. In the code above we have assumed that the configuration would be a dictionary, but we are not bound to that. Imagine that we want to improve how we deal with configurations. We can develop our custom class to handle the reading from a file, perhaps logging changes to parameters, etc. And we want it to be compatible with the <code>Experiment</code> class that we have already developed. Therefore, the duck-typing here works the other way around. We know what the class needs in order to work properly, we just develop a solution around it.<p>If you look at the code of <code>Experiment</code>, you see that it uses the configuration in two different places. First, when it checks that both <code>param1</code> and <code>param2</code> are present, through the method <code>keys</code>. We know that we will need a class that supports that method:<pre><code class=language-python>class Config:
    def __init__(self):
        ...

    def keys(self):
        ...
</code></pre><p>We also know that when we want to use the parameters, we access them through <code>configuration['param1']</code>, and to achieve this, we will need to tweak the magic method <code>__getitem__</code>. Let's add one more requirement, and is that we want to instantiate this class with a filename, which will be read by the class and the data will be loaded. For simplicity, we force the configuration file to be in YAML format. Thus, our <code>Config</code> class will look like this (you need pyyaml installed for this to work):<pre><code class=language-python>import yaml

class Config:
    def __init__(self, filename):
        with open(filename, 'r') as f:
            self._config = yaml.load(f.read(), Loader=yaml.FullLoader)

    def keys(self):
        return self._config.keys()

    def __getitem__(self, item):
        return self._config[item]
</code></pre><p>If we go step by step, you can see that when we instantiate the class, we ask for a filename, which we will open and we will load its contents into an attribute called <code>_config</code>. Note that Python doesn't have true private attributes for classes (i.e. attributes that can be accessed only within the class but not from outside). As a convention, attributes starting with an underscore, such as <code>_config</code> signal that they are not supposed to be used directly, but we can't easily enforce it.<p>Since <code>_config</code> will be a dictionary, the implementation of the <code>keys</code> method will be trivial, we just use the default dictionary method. <code>__getitem__</code> is, however much more interesting. The <code>__getitem__</code> method in Python is the one that regulates what happens when you do something like <code>c['param1']</code>. <code>item</code> in this case will be <code>param1</code>, and we want to retrieve that item from the <code>_config</code> dictionary. If you want to test this implementation, first, you need to create a file <strong>config.yml</strong> with the following:<pre><code class=language-yaml>param1: 10
param2: 5
</code></pre><p>And then you can run:<pre><code class=language-python>c = Config('config.yml')
print(c['param1'])
print(c['[param2'])
</code></pre><p>Of course, if you would like to change the value of 'param1' or 'param2', you will get an error. Covering this topic is beyond duck typing, so keep tuned because we are going to discuss it in a later tutorial.<p>Now we can put everything together, our custom configuration class and the experiment class:<pre><code class=language-python>c = Config('config.yml')
exp = Experiment(c)
exp.check_config()
exp.check_config_range()
</code></pre><p>Now you see that you are running the <code>Experiment</code> with a configuration which is not a dictionary but a custom designed class, and it works as expected.<h2>Conclusions</h2><p>If you look for the definition of duck typing, you will typically find that in Python, it is common not to verify to which data type a variable belongs. If those variables behave as expected, then you shouldn't worry. In the beginning, we saw that this is very handy because it allowed us to use a function on variables which we didn't originally intend, such as numpy array or custom classes.<p>In the second part, we saw that you can plan your code the other way around. If you assume that duck typing is a common practice (i.e. that the libraries you use don't verify the type of variables, but only their functioning), you can design your own classes in such a way that they behave as a specific data type. Our example was a class that mimics how dictionaries work, and which we used as an argument in a different object, which had no idea of our custom data type.<p>Header image by <a href=https://unsplash.com/@joshstyle?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText>JOSHUA COLEMAN</a> on Unsplash</main><div class=info-list><span class="item author">Article written by Aquiles Carattino</span></div><div class=similar-posts><h3>Related Articles:</h3><ul><li><a class=item href=http://localhost:8000/blog/intro-to-python-lambda-functions> <img alt src=/images/ivana-cajina-324103-unsplash_linkedin.width-800.jpg> <span class=date>2019-03-17</span> <span class=name>Introduction to Python Lambda Functions</span> </a><li><a class=item href=http://localhost:8000/blog/what-are-args-and-kwargs-and-when-to-use-them> <img alt src=/images/luca-bravo-217276-unsplash_linkedin.width-800.jpg> <span class=date>2019-03-10</span> <span class=name>What are args and kwargs and when to use them</span> </a><li><a class=item href=http://localhost:8000/blog/monkey-patching-and-its-consequences> <img alt src=/images/aqui_c_monkey_patching_and_its_consequences._F.width-800.png> <span class=date>2019-06-18</span> <span class=name>Monkey Patching and its consequences</span> </a></ul></div><div class=bottom-section><h4>Share your thoughts with us!</h4><div class=comments><script async crossorigin issue-term=pathname label=Comment repo=PFTL/pftl_discussions src=https://utteranc.es/client.js theme=github-light></script></div></div></div><div class=rightside><div class=support-box><h3>Support Us</h3><p>If you like the content of this website, consider buying a copy of the book <strong>Python For The Lab</strong></p><a class=button href=http://localhost:8000/books>Check out the book</a></div><div class=latest-posts><h3>Latest Articles</h3><ul><li><a href=http://localhost:8000/blog/instructions-to-build-the-python-for-the-lab-daq/>Instructions to build the Python for the Lab DAQ.</a> <span>by Aquiles Carattino, 2021-03-27</span><li><a href=http://localhost:8000/blog/using-slots-in-python-limit-dynamic-attribute-creation-and-improve-speed>Using slots in Python: limit dynamic attribute creation and improve speed</a> <span>by Aquiles Carattino, 2021-03-21</span><li><a href=http://localhost:8000/blog/getting-started-with-basler-cameras>Acquiring images from Basler Cameras</a> <span>by Aquiles Carattino, 2021-02-27</span><li><a href=http://localhost:8000/blog/singletons-instantiate-objects-only-once>Singletons: Instantiate objects only once</a> <span>by Aquiles Carattino, 2021-01-16</span><li><a href=http://localhost:8000/blog/differences-between-multiprocessing-windows-and-linux>Differences of Multiprocessing on Windows and Linux</a> <span>by Aquiles Carattino, 2020-06-13</span><li><a href=http://localhost:8000/blog/python-tip-using-else-loops>Python Tip: Using Else with Loops</a> <span>by Aquiles Carattino, 2020-05-25</span><li><a href=http://localhost:8000/blog/python-tip-ready-publish-matplotlib-figures>Python Tip: Ready to Publish Matplotlib Figures</a> <span>by Aquiles Carattino, 2020-05-18</span><li><a href=http://localhost:8000/blog/data-descriptors-bringing-attributes-next-level>Data Descriptors: Bringing Attributes to the Next level</a> <span>by Aquiles Carattino, 2020-05-16</span><li><a href=http://localhost:8000/blog/python-tips-using-sets>Python Tips: Using Sets</a> <span>by Aquiles Carattino, 2020-05-11</span><li><a href=http://localhost:8000/blog/generators-iterables-iterators-python-when-and-where>Generators, Iterables, Iterators in Python: When and Where</a> <span>by Aquiles Carattino, 2020-04-10</span></ul></div><div class=subscribe-fixed><button class=action>Never Stop Learning</button><div class=cnt><p>Join over 1000 Python developers and don't miss any updates!<form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup><input class="field required email" placeholder="Your E-Mail" id=mce-EMAIL name=EMAIL required type=email></div><div class="clear foot" id=mce-responses><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit></form><p>Or check out our <a href=/books>books</a>! <br> <a href=#>Privacy Policy</a></div></div></div></div><div class=mobile-sb-form><div class=sb-form><h4>Get all the information directly to your inbox</h4><form action=https://pythonforthelab.us21.list-manage.com/subscribe/post?u=f0d9bfa6188cdcc67890a07f6&id=8a0ca536e8&f_id=00dfebe6f0 class=validate id=mc-embedded-subscribe-form method=post name=mc-embedded-subscribe-form novalidate><div class=field-wp id=mc_embed_signup><input class="field required email" placeholder="Your E-Mail" id=mce-EMAIL name=EMAIL required type=email></div><div class="clear foot" id=mce-responses><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things - do not remove this or risk form bot signups */ <input name=b_f0d9bfa6188cdcc67890a07f6_8a0ca536e8 tabindex=-1></div><input value="Subscribe to the Newsletter" class=send-btn id=mc-embedded-subscribe name=subscribe type=submit></form></div></div></div></div></section><div class=footer><div class=container><div class=footer-cnt><p class=left>Â© Python For The Lab <span class=current-year>2023</span><p class=center><a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ rel=license> <img alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png style=border:0></a>.<p class=right><a href=http://localhost:8000/cookie-policy>Cookie Policy</a> <a href=http://localhost:8000/privacy-policy>Privacy Policy</a></div></div></div><script src=http://localhost:8000/theme/js/prism.js></script><script src=https://files.stork-search.net/releases/v1.5.0/stork.js></script><script>stork.register("sitesearch","http://localhost:8000/search-index.st")</script>